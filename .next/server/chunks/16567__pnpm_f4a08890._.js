module.exports=[71966,e=>{e.v({name:"@aws-sdk/client-eventbridge",description:"AWS SDK for JavaScript Eventbridge Client for Node.js, Browser and React Native",version:"3.946.0",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-eventbridge","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo eventbridge",test:"yarn g:vitest run","test:index":"tsc --noEmit ./test/index-types.ts && node ./test/index-objects.spec.mjs","test:watch":"yarn g:vitest watch"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.946.0","@aws-sdk/credential-provider-node":"3.946.0","@aws-sdk/middleware-host-header":"3.936.0","@aws-sdk/middleware-logger":"3.936.0","@aws-sdk/middleware-recursion-detection":"3.936.0","@aws-sdk/middleware-user-agent":"3.946.0","@aws-sdk/region-config-resolver":"3.936.0","@aws-sdk/signature-v4-multi-region":"3.946.0","@aws-sdk/types":"3.936.0","@aws-sdk/util-endpoints":"3.936.0","@aws-sdk/util-user-agent-browser":"3.936.0","@aws-sdk/util-user-agent-node":"3.946.0","@smithy/config-resolver":"^4.4.3","@smithy/core":"^3.18.7","@smithy/fetch-http-handler":"^5.3.6","@smithy/hash-node":"^4.2.5","@smithy/invalid-dependency":"^4.2.5","@smithy/middleware-content-length":"^4.2.5","@smithy/middleware-endpoint":"^4.3.14","@smithy/middleware-retry":"^4.4.14","@smithy/middleware-serde":"^4.2.6","@smithy/middleware-stack":"^4.2.5","@smithy/node-config-provider":"^4.3.5","@smithy/node-http-handler":"^4.4.5","@smithy/protocol-http":"^5.3.5","@smithy/smithy-client":"^4.9.10","@smithy/types":"^4.9.0","@smithy/url-parser":"^4.2.5","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.13","@smithy/util-defaults-mode-node":"^4.2.16","@smithy/util-endpoints":"^3.2.5","@smithy/util-middleware":"^4.2.5","@smithy/util-retry":"^4.2.5","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{"@aws-sdk/signature-v4-crt":"3.946.0","@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-eventbridge",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-eventbridge"}})},97337,e=>{"use strict";let t;var n,r,i=e.i(25126),s=e.i(4114),o=e.i(74644),a=e.i(44390),l=e.i(63781),d=e.i(51902),c=e.i(69819),u=e.i(86093),p=e.i(65262),g=e.i(42893),m=e.i(7744),h=e.i(89111),f=e.i(97149),v=e.i(32423),E=e.i(7824),y=e.i(12399),P=e.i(93695);e.i(4197);var S=e.i(54566),w=e.i(18531),R=e.i(54799),C=e.i(80736),x=e.i(96984),I=e.i(42815);let b=new x.SSMClient({region:"eu-west-1"}),A=new Map;async function O(e,t){let n=e.headers.get("x-tenant-id")?.toLowerCase().trim();if(n)return n;let r=function(e){if(!e||e.includes("localhost")||e.includes("127.0.0.1"))return null;if(e.match(/^(carousel|api)\.(dev|prod|staging)\.carousellabs\.co$/i))return"carousel-labs";if(e.match(/^(carousel|api)\.hringekjan\.is$/i))return"hringekjan";let t=e.match(/^([a-z0-9-]+)\.s3/i);return t?t[1].toLowerCase():null}(e.headers.get("host")||"");return r||"carousel-labs"}async function D(e,t){let n=`${e}:${t}`,r=A.get(n);if(r&&Date.now()-r.timestamp<3e5)return r;try{let r=await b.send(new I.GetParameterCommand({Name:`/tf/${t}/${e}/services/bg-remover/config`,WithDecryption:!0})),i=JSON.parse(r.Parameter?.Value||"{}"),s={tenant:e,...i,timestamp:Date.now()};return A.set(n,s),s}catch(r){try{let r=await b.send(new I.GetParameterCommand({Name:`/tf/${t}/platform/bg-remover/config`,WithDecryption:!0})),i=JSON.parse(r.Parameter?.Value||"{}"),s={tenant:e,...i,timestamp:Date.now()};return A.set(n,s),s}catch(t){return console.error(`Failed to load config for tenant ${e}`,{error:r,fallbackError:t}),{tenant:e,timestamp:Date.now()}}}}var N=e.i(81732),T=e.i(36422),_=e.i(16315),k=e.i(500),H=e.i(40490),$=e.i(73779),j=e.i(87362),F=e.i(85548),M=e.i(55539),U=e.i(70017),L=e.i(77270),q=e.i(39397),G=e.i(98859),V=e.i(39645),B=e.i(88710),z=e.i(40462),K=e.i(39085),W=e.i(84330);let J={environmentVariableSelector(e){if(e.AWS_SIGV4A_SIGNING_REGION_SET)return e.AWS_SIGV4A_SIGNING_REGION_SET.split(",").map(e=>e.trim());throw new W.ProviderError("AWS_SIGV4A_SIGNING_REGION_SET not set in env.",{tryNextLink:!0})},configFileSelector(e){if(e.sigv4a_signing_region_set)return(e.sigv4a_signing_region_set??"").split(",").map(e=>e.trim());throw new W.ProviderError("sigv4a_signing_region_set not set in profile.",{tryNextLink:!0})},default:void 0};var Q=e.i(493),X=e.i(83692),Y=e.i(55418),Z=e.i(81826),ee=e.i(27822);e.i(76738);var et=e.i(83733),en=e.i(77075),er=e.i(49536),ei=e.i(98796);let es="required",eo="type",ea="argv",el="isSet",ed="stringEquals",ec="getAttr",eu="booleanEquals",ep="endpoint",eg="tree",em="error",eh={[es]:!1,[eo]:"string"},ef={[es]:!0,default:!1,[eo]:"boolean"},ev={ref:"Endpoint"},eE={fn:el,[ea]:[{ref:"Region"}]},ey={ref:"Region"},eP={fn:"aws.partition",[ea]:[ey],assign:"PartitionResult"},eS={ref:"PartitionResult"},ew={fn:eu,[ea]:[{ref:"UseFIPS"},!0]},eR={fn:eu,[ea]:[{ref:"UseDualStack"},!0]},eC={url:"https://events.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:{},headers:{}},ex={},eI={ref:"EndpointId"},eb={authSchemes:[{name:"sigv4a",signingName:"events",signingRegionSet:["*"]}]},eA={fn:eu,[ea]:[!0,{fn:ec,[ea]:[eS,"supportsDualStack"]}]},eO={[em]:"DualStack is enabled but this partition does not support DualStack",[eo]:em},eD={fn:ec,[ea]:[eS,"supportsFIPS"]},eN=[{fn:el,[ea]:[ev]}],eT=[eR],e_=[eA],ek=[ew],eH={version:"1.0",parameters:{Region:eh,UseDualStack:ef,UseFIPS:ef,Endpoint:eh,EndpointId:eh},rules:[{conditions:[{fn:"not",[ea]:eN},eE,eP,{fn:ed,[ea]:[{fn:ec,[ea]:[eS,"name"]},"aws-us-gov"]},ew,eR],endpoint:eC,[eo]:ep},{conditions:[{fn:el,[ea]:[eI]},eE,eP],rules:[{conditions:[{fn:"isValidHostLabel",[ea]:[eI,!0]}],rules:[{conditions:[{fn:eu,[ea]:[{ref:"UseFIPS"},!1]}],rules:[{conditions:eN,endpoint:{url:ev,properties:eb,headers:ex},[eo]:ep},{conditions:eT,rules:[{conditions:e_,rules:[{endpoint:{url:"https://{EndpointId}.endpoint.events.{PartitionResult#dualStackDnsSuffix}",properties:eb,headers:ex},[eo]:ep}],[eo]:eg},eO],[eo]:eg},{endpoint:{url:"https://{EndpointId}.endpoint.events.{PartitionResult#dnsSuffix}",properties:eb,headers:ex},[eo]:ep}],[eo]:eg},{error:"Invalid Configuration: FIPS is not supported with EventBridge multi-region endpoints.",[eo]:em}],[eo]:eg},{error:"EndpointId must be a valid host label.",[eo]:em}],[eo]:eg},{conditions:eN,rules:[{conditions:ek,error:"Invalid Configuration: FIPS and custom endpoint are not supported",[eo]:em},{conditions:eT,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",[eo]:em},{endpoint:{url:ev,properties:ex,headers:ex},[eo]:ep}],[eo]:eg},{conditions:[eE],rules:[{conditions:[eP],rules:[{conditions:[ew,eR],rules:[{conditions:[{fn:eu,[ea]:[!0,eD]},eA],rules:[{endpoint:{url:"https://events-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ex,headers:ex},[eo]:ep}],[eo]:eg},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",[eo]:em}],[eo]:eg},{conditions:ek,rules:[{conditions:[{fn:eu,[ea]:[eD,!0]}],rules:[{conditions:[{fn:ed,[ea]:[ey,"us-gov-east-1"]}],endpoint:{url:"https://events.us-gov-east-1.amazonaws.com",properties:ex,headers:ex},[eo]:ep},{conditions:[{fn:ed,[ea]:[ey,"us-gov-west-1"]}],endpoint:{url:"https://events.us-gov-west-1.amazonaws.com",properties:ex,headers:ex},[eo]:ep},{endpoint:{url:"https://events-fips.{Region}.{PartitionResult#dnsSuffix}",properties:ex,headers:ex},[eo]:ep}],[eo]:eg},{error:"FIPS is enabled but this partition does not support FIPS",[eo]:em}],[eo]:eg},{conditions:eT,rules:[{conditions:e_,rules:[{endpoint:eC,[eo]:ep}],[eo]:eg},eO],[eo]:eg},{endpoint:{url:"https://events.{Region}.{PartitionResult#dnsSuffix}",properties:ex,headers:ex},[eo]:ep}],[eo]:eg}],[eo]:eg},{error:"Invalid Configuration: Missing Region",[eo]:em}]},e$=new er.EndpointCache({size:50,params:["Endpoint","EndpointId","Region","UseDualStack","UseFIPS"]}),ej=(e,t={})=>e$.get(e,()=>(0,ei.resolveEndpoint)(eH,{endpointParams:e,logger:t.logger}));en.customEndpointFunctions.aws=et.awsEndpointFunctions;let eF=(t=async(e,t,n)=>({operation:(0,Z.getSmithyContext)(t).operation,region:await (0,ee.normalizeProvider)(e.region)()||(()=>{throw Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),async(e,n,r)=>{if(!r)throw Error("Could not find `input` for `defaultEndpointRuleSetHttpAuthSchemeParametersProvider`");let i=await t(e,n,r),s=(0,Z.getSmithyContext)(n)?.commandInstance?.constructor?.getEndpointParameterInstructions;if(!s)throw Error(`getEndpointParameterInstructions() is not defined on \`${n.commandName}\``);return Object.assign(i,await (0,Y.resolveParams)(r,{getEndpointParameterInstructions:s},e))});function eM(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"events",region:e.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}function eU(e){return{schemeId:"aws.auth#sigv4a",signingProperties:{name:"events",region:e.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}let eL=(n=e=>{let t=[];return e.operation,t.push(eM(e)),t.push(eU(e)),t},r={"aws.auth#sigv4":eM,"aws.auth#sigv4a":eU},e=>{let t=ej(e),i=t.properties?.authSchemes;if(!i)return n(e);let s=[];for(let t of i){let n,{name:o,properties:a={},...l}=t,d=o.toLowerCase();if(o!==d&&console.warn(`HttpAuthScheme has been normalized with lowercasing: \`${o}\` to \`${d}\``),"sigv4a"===d){n="aws.auth#sigv4a";let e=i.find(e=>{let t=e.name.toLowerCase();return"sigv4a"!==t&&t.startsWith("sigv4")});if("none"===X.SignatureV4MultiRegion.sigv4aDependency()&&e)continue}else if(d.startsWith("sigv4"))n="aws.auth#sigv4";else throw Error(`Unknown HttpAuthScheme found in \`@smithy.rules#endpointRuleSet\`: \`${d}\``);let c=r[n];if(!c)throw Error(`Could not find HttpAuthOption create function for \`${n}\``);let u=c(e);u.schemeId=n,u.signingProperties={...u.signingProperties||{},...l,...a},s.push(u)}return s}),eq={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var eG=e.i(71966),eV=e.i(77941),eB=e.i(19110),ez=e.i(40313),eK=e.i(5075),eW=e.i(3180),eJ=e.i(48016),eQ=e.i(41514),eX=e.i(43735),eY=e.i(80491),eZ=e.i(32660),e0=e.i(37244),e4=e.i(79935),e3=e.i(24511),e1=e.i(64576),e6=e.i(95153),e2=e.i(4224),e9=e.i(69183),e5=e.i(240),e8=e.i(50025),e7=e.i(69502);class te extends e7.AwsSdkSigV4Signer{async sign(e,t,n){if(!e5.HttpRequest.isInstance(e))throw Error("The request is not an instance of `HttpRequest` and cannot be signed");let{config:r,signer:i,signingRegion:s,signingRegionSet:o,signingName:a}=await (0,e7.validateSigningProperties)(n),l=(await r.sigv4aSigningRegionSet?.()??o??[s]).join(",");return await i.sign(e,{signingDate:(0,e8.getSkewCorrectedDate)(r.systemClockOffset),signingRegion:l,signingService:a})}}var tt=e.i(30941),tn=e.i(36841),tr=e.i(19991),ti=e.i(29596),ts=e.i(78228),to=e.i(56719),ta=e.i(23241),tl=e.i(69967),td=e.i(16845),tc=e.i(78195);class tu extends z.Client{config;constructor(...[e]){const t=(e=>{(0,e3.emitWarningIfUnsupportedVersion)(process.version);let t=(0,e2.resolveDefaultsModeConfig)(e),n=()=>t().then(e1.loadConfigsForDefaultMode),r={apiVersion:"2015-10-07",base64Decoder:e?.base64Decoder??ti.fromBase64,base64Encoder:e?.base64Encoder??ts.toBase64,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??ej,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??eL,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new e7.AwsSdkSigV4Signer},{schemeId:"aws.auth#sigv4a",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4a"),signer:new te}],logger:e?.logger??new tn.NoOpLogger,protocol:e?.protocol??new tt.AwsJson1_1Protocol({defaultNamespace:"com.amazonaws.eventbridge",serviceTarget:"AWSEvents",awsQueryCompatible:!1}),serviceId:e?.serviceId??"EventBridge",signerConstructor:e?.signerConstructor??X.SignatureV4MultiRegion,urlParser:e?.urlParser??tr.parseUrl,utf8Decoder:e?.utf8Decoder??to.fromUtf8,utf8Encoder:e?.utf8Encoder??ta.toUtf8};(0,eB.emitWarningIfUnsupportedVersion)(process.version);let i={profile:e?.profile,logger:r.logger};return{...r,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??(0,eZ.loadConfig)(eV.NODE_AUTH_SCHEME_PREFERENCE_OPTIONS,i),bodyLengthChecker:e?.bodyLengthChecker??e6.calculateBodyLength,credentialDefaultProvider:e?.credentialDefaultProvider??ez.defaultProvider,defaultUserAgentProvider:e?.defaultUserAgentProvider??(0,eW.createDefaultUserAgentProvider)({serviceId:r.serviceId,clientVersion:eG.default.version}),maxAttempts:e?.maxAttempts??(0,eZ.loadConfig)(B.NODE_MAX_ATTEMPT_CONFIG_OPTIONS,e),region:e?.region??(0,eZ.loadConfig)(eJ.NODE_REGION_CONFIG_OPTIONS,{...eJ.NODE_REGION_CONFIG_FILE_OPTIONS,...i}),requestHandler:e0.NodeHttpHandler.create(e?.requestHandler??n),retryMode:e?.retryMode??(0,eZ.loadConfig)({...B.NODE_RETRY_MODE_CONFIG_OPTIONS,default:async()=>(await n()).retryMode||e9.DEFAULT_RETRY_MODE},e),sha256:e?.sha256??eY.Hash.bind(null,"sha256"),sigv4aSigningRegionSet:e?.sigv4aSigningRegionSet??(0,eZ.loadConfig)(J,i),streamCollector:e?.streamCollector??e4.streamCollector,useDualstackEndpoint:e?.useDualstackEndpoint??(0,eZ.loadConfig)(eQ.NODE_USE_DUALSTACK_ENDPOINT_CONFIG_OPTIONS,i),useFipsEndpoint:e?.useFipsEndpoint??(0,eZ.loadConfig)(eX.NODE_USE_FIPS_ENDPOINT_CONFIG_OPTIONS,i),userAgentAppId:e?.userAgentAppId??(0,eZ.loadConfig)(eK.NODE_APP_ID_CONFIG_OPTIONS,i)}})(e||{});super(t),this.initConfig=t;const n=(e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"events"}))(t),r=(0,$.resolveUserAgentConfig)(n),i=(0,B.resolveRetryConfig)(r),s=(0,j.resolveRegionConfig)(i),o=(0,T.resolveHostHeaderConfig)(s),a=((e,t)=>{let n,r,i,s=Object.assign((0,tl.getAwsRegionExtensionConfiguration)(e),(0,tc.getDefaultExtensionConfiguration)(e),(0,td.getHttpHandlerExtensionConfiguration)(e),(n=e.httpAuthSchemes,r=e.httpAuthSchemeProvider,i=e.credentials,{setHttpAuthScheme(e){let t=n.findIndex(t=>t.schemeId===e.schemeId);-1===t?n.push(e):n.splice(t,1,e)},httpAuthSchemes:()=>n,setHttpAuthSchemeProvider(e){r=e},httpAuthSchemeProvider:()=>r,setCredentials(e){i=e},credentials:()=>i}));return t.forEach(e=>e.configure(s)),Object.assign(e,(0,tl.resolveAwsRegionExtensionConfiguration)(s),(0,tc.resolveDefaultRuntimeConfig)(s),(0,td.resolveHttpHandlerRuntimeConfig)(s),{httpAuthSchemes:s.httpAuthSchemes(),httpAuthSchemeProvider:s.httpAuthSchemeProvider(),credentials:s.credentials()})})((e=>{var t;return Object.assign(((t=(0,Q.resolveAwsSdkSigV4Config)(e)).sigv4aSigningRegionSet=(0,K.normalizeProvider)(t.sigv4aSigningRegionSet),t),{authSchemePreference:(0,ee.normalizeProvider)(e.authSchemePreference??[])})})((0,G.resolveEndpointConfig)(o)),e?.extensions||[]);this.config=a,this.middlewareStack.use((0,L.getSchemaSerdePlugin)(this.config)),this.middlewareStack.use((0,H.getUserAgentPlugin)(this.config)),this.middlewareStack.use((0,V.getRetryPlugin)(this.config)),this.middlewareStack.use((0,q.getContentLengthPlugin)(this.config)),this.middlewareStack.use((0,T.getHostHeaderPlugin)(this.config)),this.middlewareStack.use((0,_.getLoggerPlugin)(this.config)),this.middlewareStack.use((0,k.getRecursionDetectionPlugin)(this.config)),this.middlewareStack.use((0,M.getHttpAuthSchemeEndpointRuleSetPlugin)(this.config,{httpAuthSchemeParametersProvider:eF,identityProviderConfigProvider:async e=>new F.DefaultIdentityProviderConfig({"aws.auth#sigv4":e.credentials,"aws.auth#sigv4a":e.credentials})})),this.middlewareStack.use((0,U.getHttpSigningPlugin)(this.config))}destroy(){super.destroy()}}var tp=e.i(20231),tg=e.i(22830),tm=e.i(18526),th=e.i(72232);class tf extends th.ServiceException{constructor(e){super(e),Object.setPrototypeOf(this,tf.prototype)}}class tv extends tf{name="AccessDeniedException";$fault="client";constructor(e){super({name:"AccessDeniedException",$fault:"client",...e}),Object.setPrototypeOf(this,tv.prototype)}}class tE extends tf{name="ConcurrentModificationException";$fault="client";constructor(e){super({name:"ConcurrentModificationException",$fault:"client",...e}),Object.setPrototypeOf(this,tE.prototype)}}class ty extends tf{name="InternalException";$fault="server";constructor(e){super({name:"InternalException",$fault:"server",...e}),Object.setPrototypeOf(this,ty.prototype)}}class tP extends tf{name="InvalidStateException";$fault="client";constructor(e){super({name:"InvalidStateException",$fault:"client",...e}),Object.setPrototypeOf(this,tP.prototype)}}class tS extends tf{name="OperationDisabledException";$fault="client";constructor(e){super({name:"OperationDisabledException",$fault:"client",...e}),Object.setPrototypeOf(this,tS.prototype)}}class tw extends tf{name="ResourceNotFoundException";$fault="client";constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),Object.setPrototypeOf(this,tw.prototype)}}class tR extends tf{name="IllegalStatusException";$fault="client";constructor(e){super({name:"IllegalStatusException",$fault:"client",...e}),Object.setPrototypeOf(this,tR.prototype)}}class tC extends tf{name="LimitExceededException";$fault="client";constructor(e){super({name:"LimitExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,tC.prototype)}}class tx extends tf{name="ResourceAlreadyExistsException";$fault="client";constructor(e){super({name:"ResourceAlreadyExistsException",$fault:"client",...e}),Object.setPrototypeOf(this,tx.prototype)}}class tI extends tf{name="InvalidEventPatternException";$fault="client";constructor(e){super({name:"InvalidEventPatternException",$fault:"client",...e}),Object.setPrototypeOf(this,tI.prototype)}}class tb extends tf{name="ThrottlingException";$fault="client";constructor(e){super({name:"ThrottlingException",$fault:"client",...e}),Object.setPrototypeOf(this,tb.prototype)}}class tA extends tf{name="ManagedRuleException";$fault="client";constructor(e){super({name:"ManagedRuleException",$fault:"client",...e}),Object.setPrototypeOf(this,tA.prototype)}}class tO extends tf{name="PolicyLengthExceededException";$fault="client";constructor(e){super({name:"PolicyLengthExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,tO.prototype)}}let tD="AppSyncParameters",tN="BatchParameters",tT="ClientID",t_="CapacityProviderStrategy",tk="ClientSecret",tH="DeadLetterConfig",t$="DetailType",tj="Detail",tF="EventBusName",tM="ErrorCode",tU="EndpointId",tL="EventId",tq="ErrorMessage",tG="EcsParameters",tV="Entries",tB="FailoverConfig",tz="GraphQLOperation",tK="HeaderParameters",tW="HttpParameters",tJ="InputTransformer",tQ="IsValueSecret",tX="KinesisParameters",tY="Name",tZ="NetworkConfiguration",t0="PlacementConstraints",t4="PlacementStrategy",t3="Primary",t1="QueryStringParameters",t6="RoutingConfig",t2="ResourceConfigurationArn",t9="RunCommandParameters",t5="RunCommandTargets",t8="ReplicationConfig",t7="RedshiftDataParameters",ne="RetryPolicy",nt="Resources",nn="SageMakerPipelineParameters",nr="SqsParameters",ni="Secondary",ns="Source",no="Sqls",na="State",nl="Time",nd="Value",nc="client",nu="error",np="message",ng="smithy.ts.sdk.synthetic.com.amazonaws.eventbridge",nm="type",nh="com.amazonaws.eventbridge";var nf=[0,nh,"AuthHeaderParametersSensitive",8,0],nv=[0,nh,tz,8,0],nE=[0,nh,"HeaderValueSensitive",8,0],ny=[0,nh,"QueryStringValueSensitive",8,0],nP=[0,nh,"SensitiveString",8,0],nS=[0,nh,"Sql",8,0],nw=[-3,nh,"AccessDeniedException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nw,tv);var nR=[3,nh,tD,0,[tz],[[()=>nv,0]]],nC=[3,nh,"AwsVpcConfiguration",0,["Subnets","SecurityGroups","AssignPublicIp"],[64,64,0]],nx=[3,nh,"BatchArrayProperties",0,["Size"],[1]],nI=[3,nh,tN,0,["JobDefinition","JobName","ArrayProperties","RetryStrategy"],[0,0,()=>nx,()=>nb]],nb=[3,nh,"BatchRetryStrategy",0,["Attempts"],[1]],nA=[3,nh,"CapacityProviderStrategyItem",0,["capacityProvider","weight","base"],[0,1,1]],nO=[-3,nh,"ConcurrentModificationException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nO,tE);var nD=[3,nh,"ConnectionBodyParameter",0,["Key",nd,tQ],[0,[()=>nP,0],2]],nN=[3,nh,"ConnectionHeaderParameter",0,["Key",nd,tQ],[0,[()=>nE,0],2]],nT=[3,nh,"ConnectionHttpParameters",0,[tK,t1,"BodyParameters"],[[()=>rh,0],[()=>rf,0],[()=>rm,0]]],n_=[3,nh,"ConnectionOAuthClientResponseParameters",0,[tT],[0]],nk=[3,nh,"ConnectionQueryStringParameter",0,["Key",nd,tQ],[0,[()=>ny,0],2]],nH=[3,nh,"ConnectivityResourceConfigurationArn",0,[t2],[0]],n$=[3,nh,"CreateConnectionOAuthClientRequestParameters",0,[tT,tk],[0,[()=>nf,0]]],nj=[3,nh,tH,0,["Arn"],[0]],nF=[3,nh,"DescribeConnectionResourceParameters",0,[t2,"ResourceAssociationArn"],[0,0]],nM=[3,nh,tG,0,["TaskDefinitionArn","TaskCount","LaunchType",tZ,"PlatformVersion","Group",t_,"EnableECSManagedTags","EnableExecuteCommand",t0,t4,"PropagateTags","ReferenceId","Tags"],[0,1,0,()=>nX,0,0,()=>rg,2,2,()=>rv,()=>rE,0,0,()=>rC]],nU=[3,nh,"EndpointEventBus",0,["EventBusArn"],[0]],nL=[3,nh,tB,0,[t3,ni],[()=>n3,()=>ra]],nq=[3,nh,tW,0,["PathParameterValues",tK,t1],[64,128,128]],nG=[-3,nh,"IllegalStatusException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nG,tR);var nV=[3,nh,tJ,0,["InputPathsMap","InputTemplate"],[128,0]],nB=[-3,nh,"InternalException",{[nu]:"server"},[np],[0]];tm.TypeRegistry.for(nh).registerError(nB,ty);var nz=[-3,nh,"InvalidEventPatternException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nz,tI);var nK=[-3,nh,"InvalidStateException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nK,tP);var nW=[3,nh,tX,0,["PartitionKeyPath"],[0]],nJ=[-3,nh,"LimitExceededException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nJ,tC);var nQ=[-3,nh,"ManagedRuleException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nQ,tA);var nX=[3,nh,tZ,0,["awsvpcConfiguration"],[()=>nC]],nY=[-3,nh,"OperationDisabledException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(nY,tS);var nZ=[3,nh,"PlacementConstraint",0,[nm,"expression"],[0,0]],n0=[3,nh,t4,0,[nm,"field"],[0,0]],n4=[-3,nh,"PolicyLengthExceededException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(n4,tO);var n3=[3,nh,t3,0,["HealthCheck"],[0]],n1=[3,nh,"PutEventsRequest",0,[tV,tU],[()=>ry,0]],n6=[3,nh,"PutEventsRequestEntry",0,[nl,ns,nt,t$,tj,tF,"TraceHeader"],[4,0,64,0,0,0,0]],n2=[3,nh,"PutEventsResponse",0,["FailedEntryCount",tV],[1,()=>rP]],n9=[3,nh,"PutEventsResultEntry",0,[tL,tM,tq],[0,0,0]],n5=[3,nh,t7,0,["SecretManagerArn","Database","DbUser","Sql","StatementName","WithEvent",no],[0,0,0,[()=>nS,0],0,2,[()=>rR,0]]],n8=[3,nh,t8,0,[na],[0]],n7=[-3,nh,"ResourceAlreadyExistsException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(n7,tx);var re=[-3,nh,"ResourceNotFoundException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(re,tw);var rt=[3,nh,ne,0,["MaximumRetryAttempts","MaximumEventAgeInSeconds"],[1,1]],rn=[3,nh,t6,0,[tB],[()=>nL]],rr=[3,nh,t9,0,[t5],[()=>rS]],ri=[3,nh,"RunCommandTarget",0,["Key","Values"],[0,64]],rs=[3,nh,"SageMakerPipelineParameter",0,[tY,nd],[0,0]],ro=[3,nh,nn,0,["PipelineParameterList"],[()=>rw]],ra=[3,nh,ni,0,["Route"],[0]],rl=[3,nh,nr,0,["MessageGroupId"],[0]],rd=[3,nh,"Tag",0,["Key",nd],[0,0]],rc=[-3,nh,"ThrottlingException",{[nu]:nc},[np],[0]];tm.TypeRegistry.for(nh).registerError(rc,tb);var ru=[3,nh,"UpdateConnectionOAuthClientRequestParameters",0,[tT,tk],[0,[()=>nf,0]]],rp=[-3,ng,"EventBridgeServiceException",0,[],[]];tm.TypeRegistry.for(ng).registerError(rp,tf);var rg=[1,nh,t_,0,()=>nA],rm=[1,nh,"ConnectionBodyParametersList",0,[()=>nD,0]],rh=[1,nh,"ConnectionHeaderParametersList",0,[()=>nN,0]],rf=[1,nh,"ConnectionQueryStringParametersList",0,[()=>nk,0]],rv=[1,nh,t0,0,()=>nZ],rE=[1,nh,"PlacementStrategies",0,()=>n0],ry=[1,nh,"PutEventsRequestEntryList",0,()=>n6],rP=[1,nh,"PutEventsResultEntryList",0,()=>n9],rS=[1,nh,t5,0,()=>ri],rw=[1,nh,"SageMakerPipelineParameterList",0,()=>rs],rR=[1,nh,no,8,[()=>nS,0]],rC=[1,nh,"TagList",0,()=>rd],rx=[9,nh,"PutEvents",0,()=>n1,()=>n2];class rI extends tg.Command.classBuilder().ep({...eq,EndpointId:{type:"contextParams",name:"EndpointId"}}).m(function(e,t,n,r){return[(0,tp.getEndpointPlugin)(n,e.getEndpointParameterInstructions())]}).s("AWSEvents","PutEvents",{}).n("EventBridgeClient","PutEventsCommand").sc(rx).build(){}async function rb(e){let t=Date.now(),n=(0,R.randomUUID)();try{let r,i=process.env.STAGE||"dev",s=await O(e,i),o=await e.json(),{imageUrl:a,imageBase64:l,outputFormat:d,quality:c,productId:u,autoTrim:p,centerSubject:g,enhanceColors:m,targetWidth:h,targetHeight:f,generateDescription:v,productName:E}=C.ProcessRequestSchema.parse(o);console.log("Processing image request",{jobId:n,tenant:s,productId:u,hasUrl:!!a,hasBase64:!!l,outputFormat:d}),await D(s,i);let y={format:d,quality:c,autoTrim:p,centerSubject:g,enhanceColors:m,targetSize:h&&f?{width:h,height:f}:void 0,generateDescription:v,productName:E};if(a)r=await (0,N.processImageFromUrl)(a,y);else{if(!l)return w.NextResponse.json((0,N.createProcessResult)(!1,void 0,void 0,"No image provided",Date.now()-t),{status:400});r=await (0,N.processImageFromBase64)(l,"image/png",y)}let P=r.outputBuffer.toString("base64"),S=`data:${"png"===d?"image/png":"webp"===d?"image/webp":"image/jpeg"};base64,${P}`,R=Date.now()-t;console.log("Image processed successfully",{jobId:n,processingTimeMs:R,outputSize:P.length,originalSize:r.metadata.originalSize,processedSize:r.metadata.processedSize});try{let e=new tu({region:"eu-west-1"}),t={file_hash:n,original_filename:a&&a.split("/").pop()||"input.png",output_filename:"output.png",output_path:"/processed",output_key:`processed/${n}.png`,model_name:"bedrock-claude-vision",processing_time_ms:R,timestamp:new Date().toISOString(),tenant_id:s,metadata:r.metadata},i={Source:"carousel.bg-remover",DetailType:"CarouselImageProcessed",Detail:JSON.stringify(t)};await e.send(new rI({Entries:[i]})),console.log("CarouselImageProcessed event emitted",{jobId:n})}catch(e){console.error("Failed to emit CarouselImageProcessed event",{jobId:n,error:e})}return w.NextResponse.json({success:!0,jobId:n,outputUrl:S,processingTimeMs:R,metadata:r.metadata,productDescription:r.productDescription,bilingualDescription:r.bilingualDescription})}catch(i){let e=Date.now()-t,r=i instanceof Error?i.message:"Unknown error";if(console.error("Image processing failed",{jobId:n,error:r,processingTimeMs:e}),i instanceof Error&&"ZodError"===i.name)return w.NextResponse.json((0,N.createProcessResult)(!1,void 0,void 0,`Validation error: ${r}`,e),{status:400});return w.NextResponse.json((0,N.createProcessResult)(!1,void 0,void 0,r,e),{status:500})}}async function rA(){return new w.NextResponse(null,{status:200,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization, X-Tenant-Id"}})}e.s(["OPTIONS",()=>rA,"POST",()=>rb,"maxDuration",0,60,"runtime",0,"nodejs"],87376);var rO=e.i(87376);let rD=new i.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/process/route",pathname:"/api/process",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/enterprise-packages/services/bg-remover/app/api/process/route.ts",nextConfigOutput:"standalone",userland:rO}),{workAsyncStorage:rN,workUnitAsyncStorage:rT,serverHooks:r_}=rD;function rk(){return(0,o.patchFetch)({workAsyncStorage:rN,workUnitAsyncStorage:rT})}async function rH(e,t,n){rD.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let r="/api/process/route";r=r.replace(/\/index$/,"")||"/";let i=await rD.prepare(e,t,{srcPage:r,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:o,params:w,nextConfig:R,parsedUrl:C,isDraftMode:x,prerenderManifest:I,routerServerContext:b,isOnDemandRevalidate:A,revalidateOnlyGenerated:O,resolvedPathname:D,clientReferenceManifest:N,serverActionsManifest:T}=i,_=(0,u.normalizeAppPath)(r),k=!!(I.dynamicRoutes[_]||I.routes[D]),H=async()=>((null==b?void 0:b.render404)?await b.render404(e,t,C,!1):t.end("This page could not be found"),null);if(k&&!x){let e=!!I.routes[D],t=I.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(R.experimental.adapterPath)return await H();throw new P.NoFallbackError}}let $=null;!k||rD.isDev||x||($="/index"===($=D)?"/":$);let j=!0===rD.isDev||!k,F=k&&!j;T&&N&&(0,d.setReferenceManifestsSingleton)({page:r,clientReferenceManifest:N,serverActionsManifest:T,serverModuleMap:(0,c.createServerModuleMap)({serverActionsManifest:T})});let M=e.method||"GET",U=(0,l.getTracer)(),L=U.getActiveScopeSpan(),q={params:w,prerenderManifest:I,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,r)=>rD.onRequestError(e,t,r,b)},sharedContext:{buildId:o}},G=new p.NodeNextRequest(e),V=new p.NodeNextResponse(t),B=g.NextRequestAdapter.fromNodeNextRequest(G,(0,g.signalFromNodeResponse)(t));try{let i=async e=>rD.handle(B,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=U.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=n.get("next.route");if(i){let t=`${M} ${i}`;e.setAttributes({"next.route":i,"http.route":i,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${r}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),d=async a=>{var l,d;let c=async({previousCacheEntry:s})=>{try{if(!o&&A&&O&&!s)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await i(a);e.fetchMetrics=q.renderOpts.fetchMetrics;let l=q.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let d=q.renderOpts.collectedTags;if(!k)return await (0,f.sendResponse)(G,V,r,q.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,v.toNodeOutgoingHttpHeaders)(r.headers);d&&(t[y.NEXT_CACHE_TAGS_HEADER]=d),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,i=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:S.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:i}}}}catch(t){throw(null==s?void 0:s.isStale)&&await rD.onRequestError(e,t,{routerKind:"App Router",routePath:r,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:A})},b),t}},u=await rD.handleResponse({req:e,nextConfig:R,cacheKey:$,routeKind:s.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:I,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:O,responseGenerator:c,waitUntil:n.waitUntil,isMinimalMode:o});if(!k)return null;if((null==u||null==(l=u.value)?void 0:l.kind)!==S.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(d=u.value)?void 0:d.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",A?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),x&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,v.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&k||p.delete(y.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,E.getCacheControlHeader)(u.cacheControl)),await (0,f.sendResponse)(G,V,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};L?await d(L):await U.withPropagatedContext(e.headers,()=>U.trace(m.BaseServerSpan.handleRequest,{spanName:`${M} ${r}`,kind:l.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},d))}catch(t){if(t instanceof P.NoFallbackError||await rD.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,h.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:A})}),k)throw t;return await (0,f.sendResponse)(G,V,new Response(null,{status:500})),null}}e.s(["handler",()=>rH,"patchFetch",()=>rk,"routeModule",()=>rD,"serverHooks",()=>r_,"workAsyncStorage",()=>rN,"workUnitAsyncStorage",()=>rT],97337)}];

//# sourceMappingURL=16567__pnpm_f4a08890._.js.map