module.exports=[93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},70406,(e,r,t)=>{r.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},22734,(e,r,t)=>{r.exports=e.x("fs",()=>require("fs"))},35926,e=>{"use strict";var r=e.i(48856);let t=async e=>{let t=await (0,r.loadSharedConfigFiles)(e);return((...e)=>{let r={};for(let t of e)for(let[e,s]of Object.entries(t))void 0!==r[e]?Object.assign(r[e],s):r[e]=s;return r})(t.configFile,t.credentialsFile)};e.s(["parseKnownFiles",0,t],35926)},24868,(e,r,t)=>{r.exports=e.x("fs/promises",()=>require("fs/promises"))},81823,46010,e=>{"use strict";var r=e.i(24868),t=e.i(54799),s=e.i(14747),o=e.i(1815);let i=e=>{let r=(0,t.createHash)("sha1").update(e).digest("hex");return(0,s.join)((0,o.getHomeDir)(),".aws","sso","cache",`${r}.json`)};e.s(["getSSOTokenFilepath",0,i],46010);let n={},a=async e=>{if(n[e])return n[e];let t=i(e);return JSON.parse(await (0,r.readFile)(t,"utf8"))};e.s(["getSSOTokenFromFile",0,a,"tokenIntercept",0,n],81823)},77335,e=>{"use strict";var r=e.i(84330);class t extends r.ProviderError{name="TokenProviderError";constructor(e,r=!0){super(e,r),Object.setPrototypeOf(this,t.prototype)}}e.s(["TokenProviderError",()=>t])},44569,e=>{"use strict";var r=e.i(49079),t=e.i(23317),s=e.i(40273);let o=e=>Object.entries(e).filter(([e])=>e.startsWith(t.IniSectionType.SSO_SESSION+s.CONFIG_PREFIX_SEPARATOR)).reduce((e,[r,t])=>({...e,[r.substring(r.indexOf(s.CONFIG_PREFIX_SEPARATOR)+1)]:t}),{});var i=e.i(98160),n=e.i(96370);let a=()=>({}),l=async(e={})=>(0,n.readFile)(e.configFilepath??(0,r.getConfigFilepath)()).then(i.parseIni).then(o).catch(a);e.s(["loadSsoSessionData",0,l],44569)},7992,e=>{"use strict";var r=e.i(77335),t=e.i(84396),s=e.i(81823),o=e.i(44569),i=e.i(35926);let n="To refresh this SSO session run 'aws sso login' with the corresponding profile.",a=async(r,t={})=>{let{SSOOIDCClient:s}=await e.A(80194),o=e=>t.clientConfig?.[e]??t.parentClientConfig?.[e];return new s(Object.assign({},t.clientConfig??{},{region:r??t.clientConfig?.region,logger:o("logger"),userAgentAppId:o("userAgentAppId")}))},l=async(r,t,s={})=>{let{CreateTokenCommand:o}=await e.A(80194);return(await a(t,s)).send(new o({clientId:r.clientId,clientSecret:r.clientSecret,refreshToken:r.refreshToken,grantType:"refresh_token"}))},c=e=>{if(e.expiration&&e.expiration.getTime()<Date.now())throw new r.TokenProviderError(`Token is expired. ${n}`,!1)},d=(e,t,s=!1)=>{if(void 0===t)throw new r.TokenProviderError(`Value not present for '${e}' in SSO Token${s?". Cannot refresh":""}. ${n}`,!1)};var p=e.i(46010);let{writeFile:u}=e.i(22734).promises,h=new Date(0);e.s(["fromSso",0,(e={})=>async({callerClientConfig:a}={})=>{let f,v={...e,parentClientConfig:{...a,...e.parentClientConfig}};v.logger?.debug("@aws-sdk/token-providers - fromSso");let m=await (0,i.parseKnownFiles)(v),_=(0,t.getProfileName)({profile:v.profile??a?.profile}),g=m[_];if(g){if(!g.sso_session)throw new r.TokenProviderError(`Profile '${_}' is missing required property 'sso_session'.`)}else throw new r.TokenProviderError(`Profile '${_}' could not be found in shared credentials file.`,!1);let S=g.sso_session,w=(await (0,o.loadSsoSessionData)(v))[S];if(!w)throw new r.TokenProviderError(`Sso session '${S}' could not be found in shared credentials file.`,!1);for(let e of["sso_start_url","sso_region"])if(!w[e])throw new r.TokenProviderError(`Sso session '${S}' is missing required property '${e}'.`,!1);w.sso_start_url;let x=w.sso_region;try{f=await (0,s.getSSOTokenFromFile)(S)}catch(e){throw new r.TokenProviderError(`The SSO session token associated with profile=${_} was not found or is invalid. ${n}`,!1)}d("accessToken",f.accessToken),d("expiresAt",f.expiresAt);let{accessToken:k,expiresAt:E}=f,T={token:k,expiration:new Date(E)};if(T.expiration.getTime()-Date.now()>3e5)return T;if(Date.now()-h.getTime()<3e4)return c(T),T;d("clientId",f.clientId,!0),d("clientSecret",f.clientSecret,!0),d("refreshToken",f.refreshToken,!0);try{h.setTime(Date.now());let e=await l(f,x,v);d("accessToken",e.accessToken),d("expiresIn",e.expiresIn);let r=new Date(Date.now()+1e3*e.expiresIn);try{var y;let t;await (y={...f,accessToken:e.accessToken,expiresAt:r.toISOString(),refreshToken:e.refreshToken},t=(0,p.getSSOTokenFilepath)(S),u(t,JSON.stringify(y,null,2)))}catch(e){}return{token:e.accessToken,expiration:r}}catch(e){return c(T),T}}],7992)},80055,e=>{"use strict";var r=e.i(18795),t=e.i(3993);let s="AWS_ACCESS_KEY_ID",o="AWS_SECRET_ACCESS_KEY",i="AWS_SESSION_TOKEN",n="AWS_CREDENTIAL_EXPIRATION",a="AWS_CREDENTIAL_SCOPE",l="AWS_ACCOUNT_ID";e.s(["ENV_ACCOUNT_ID",0,l,"ENV_CREDENTIAL_SCOPE",0,a,"ENV_EXPIRATION",0,n,"ENV_KEY",0,s,"ENV_SECRET",0,o,"ENV_SESSION",0,i,"fromEnv",0,e=>async()=>{e?.logger?.debug("@aws-sdk/credential-provider-env - fromEnv");let c=process.env[s],d=process.env[o],p=process.env[i],u=process.env[n],h=process.env[a],f=process.env[l];if(c&&d){let e={accessKeyId:c,secretAccessKey:d,...p&&{sessionToken:p},...u&&{expiration:new Date(u)},...h&&{credentialScope:h},...f&&{accountId:f}};return(0,r.setCredentialFeature)(e,"CREDENTIALS_ENV_VARS","g"),e}throw new t.CredentialsProviderError("Unable to find environment variable credentials.",{logger:e?.logger})}])},5847,e=>{"use strict";var r=e.i(72280),t=e.i(240),s=e.i(4676),o=e.i(86403);class i extends o.HttpProtocol{async serializeRequest(e,s,o){let i,n=this.serializer,a={},l={},c=await o.endpoint(),d=r.NormalizedSchema.of(e?.input),p=d.getSchema(),u=new t.HttpRequest({protocol:"",hostname:"",port:void 0,path:"/",fragment:void 0,query:a,headers:l,body:void 0});c&&(this.updateServiceEndpoint(u,c),this.setHostPrefix(u,e,s));let h={...s};if(s){let e=d.getEventStreamMember();if(e){if(h[e]){let r={};for(let[t,s]of d.structIterator())t!==e&&h[t]&&(n.write(s,h[t]),r[t]=n.flush());i=await this.serializeEventStream({eventStream:h[e],requestSchema:d,initialRequest:r})}}else n.write(p,h),i=n.flush()}return u.headers=l,u.query=a,u.body=i,u.method="POST",u}async deserializeResponse(e,t,o){let i=this.deserializer,n=r.NormalizedSchema.of(e.output),a={};if(o.statusCode>=300){let r=await (0,s.collectBody)(o.body,t);throw r.byteLength>0&&Object.assign(a,await i.read(15,r)),await this.handleError(e,t,o,a,this.deserializeMetadata(o)),Error("@smithy/core/protocols - RPC Protocol error handler failed to throw.")}for(let e in o.headers){let r=o.headers[e];delete o.headers[e],o.headers[e.toLowerCase()]=r}let l=n.getEventStreamMember();if(l)a[l]=await this.deserializeEventStream({response:o,responseSchema:n,initialResponseContainer:a});else{let e=await (0,s.collectBody)(o.body,t);e.byteLength>0&&Object.assign(a,await i.read(n,e))}return a.$metadata=this.deserializeMetadata(o),a}}e.s(["RpcProtocol",()=>i])},26522,e=>{"use strict";var r=e.i(96984),t=e.i(42815);let s=new r.SSMClient({region:process.env.AWS_REGION||"eu-west-1"}),o=null,i=0;async function n(e,r=!1){try{let o=await s.send(new t.GetParameterCommand({Name:e,WithDecryption:r}));return o.Parameter?.Value||null}catch(r){return console.error(`Failed to get SSM parameter ${e}:`,r),null}}async function a(e="carousel-labs",r=process.env.STAGE||"dev"){if(o&&Date.now()<i)return o;let t=`/tf/${r}/${e}/services/bg-remover/config`,s=await n(t);if(s)try{return o=JSON.parse(s),i=Date.now()+3e5,o}catch(e){console.error("Failed to parse config JSON:",e)}let l={bedrock:{modelId:"anthropic.claude-3-5-sonnet-20241022-v2:0",region:"us-east-1",maxTokens:4096},s3:{inputBucket:`smartgo-s3tables-${r}-${e}`,outputBucket:`bg-remover-${r}-${e}-output`,region:"eu-west-1"},processing:{maxImageSizeMb:10,supportedFormats:["jpg","jpeg","png","webp","heic"],defaultQuality:95}};return o=l,i=Date.now()+3e5,l}e.s(["loadConfig",()=>a])},5389,e=>{e.v(r=>Promise.all(["server/chunks/[externals]_node:async_hooks_b485b2a4._.js"].map(r=>e.l(r))).then(()=>r(78500)))},54462,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__8604fa31._.js"].map(r=>e.l(r))).then(()=>r(26423)))},40077,e=>{e.v(r=>Promise.all(["server/chunks/45283_@aws-sdk_credential-provider-http_dist-es_index_cde35d3b.js"].map(r=>e.l(r))).then(()=>r(7541)))},35117,e=>{e.v(r=>Promise.all(["server/chunks/46b35_@aws-sdk_credential-provider-sso_dist-es_96c2f486._.js"].map(r=>e.l(r))).then(()=>r(77458)))},6772,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__196c8ed9._.js"].map(r=>e.l(r))).then(()=>r(81386)))},94343,e=>{e.v(r=>Promise.all(["server/chunks/[root-of-the-server]__e48a68d7._.js"].map(r=>e.l(r))).then(()=>r(84047)))},37104,e=>{e.v(r=>Promise.all(["server/chunks/16567__pnpm_910a5a5e._.js"].map(r=>e.l(r))).then(()=>r(12193)))},45961,e=>{e.v(r=>Promise.all(["server/chunks/171ef_@smithy_core_dist-es_submodules_event-streams_index_d097d588.js"].map(r=>e.l(r))).then(()=>r(89758)))},80194,e=>{e.v(r=>Promise.all(["server/chunks/16567__pnpm_b491f883._.js","server/chunks/6b371_@aws-sdk_nested-clients_dist-es_submodules_sso-oidc_index_36689ca8.js"].map(r=>e.l(r))).then(()=>r(15425)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__531f2dd1._.js.map