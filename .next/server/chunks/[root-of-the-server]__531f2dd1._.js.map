{"version":3,"sources":["../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bshared-ini-file-loader%404.4.0/node_modules/%40smithy/shared-ini-file-loader/dist-es/parseKnownFiles.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bshared-ini-file-loader%404.4.0/node_modules/%40smithy/shared-ini-file-loader/dist-es/mergeConfigFiles.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bshared-ini-file-loader%404.4.0/node_modules/%40smithy/shared-ini-file-loader/dist-es/getSSOTokenFromFile.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bshared-ini-file-loader%404.4.0/node_modules/%40smithy/shared-ini-file-loader/dist-es/getSSOTokenFilepath.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bproperty-provider%404.2.5/node_modules/%40smithy/property-provider/dist-es/TokenProviderError.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bshared-ini-file-loader%404.4.0/node_modules/%40smithy/shared-ini-file-loader/dist-es/loadSsoSessionData.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bshared-ini-file-loader%404.4.0/node_modules/%40smithy/shared-ini-file-loader/dist-es/getSsoSessionData.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/fromSso.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/constants.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/getSsoOidcClient.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/getNewSsoOidcToken.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/validateTokenExpiry.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/validateTokenKey.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Btoken-providers%403.946.0/node_modules/%40aws-sdk/token-providers/dist-es/writeSSOTokenToFile.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40aws-sdk%2Bcredential-provider-env%403.946.0/node_modules/%40aws-sdk/credential-provider-env/dist-es/fromEnv.js","../../../../../../enterprise-packages/services/bg-remover/node_modules/.pnpm/%40smithy%2Bcore%403.18.7/node_modules/%40smithy/core/dist-es/submodules/protocols/RpcProtocol.js","../../../../../../enterprise-packages/services/bg-remover/lib/config/loader.ts"],"sourcesContent":["import { loadSharedConfigFiles } from \"./loadSharedConfigFiles\";\nimport { mergeConfigFiles } from \"./mergeConfigFiles\";\nexport const parseKnownFiles = async (init) => {\n    const parsedFiles = await loadSharedConfigFiles(init);\n    return mergeConfigFiles(parsedFiles.configFile, parsedFiles.credentialsFile);\n};\n","export const mergeConfigFiles = (...files) => {\n    const merged = {};\n    for (const file of files) {\n        for (const [key, values] of Object.entries(file)) {\n            if (merged[key] !== undefined) {\n                Object.assign(merged[key], values);\n            }\n            else {\n                merged[key] = values;\n            }\n        }\n    }\n    return merged;\n};\n","import { readFile } from \"fs/promises\";\nimport { getSSOTokenFilepath } from \"./getSSOTokenFilepath\";\nexport const tokenIntercept = {};\nexport const getSSOTokenFromFile = async (id) => {\n    if (tokenIntercept[id]) {\n        return tokenIntercept[id];\n    }\n    const ssoTokenFilepath = getSSOTokenFilepath(id);\n    const ssoTokenText = await readFile(ssoTokenFilepath, \"utf8\");\n    return JSON.parse(ssoTokenText);\n};\n","import { createHash } from \"crypto\";\nimport { join } from \"path\";\nimport { getHomeDir } from \"./getHomeDir\";\nexport const getSSOTokenFilepath = (id) => {\n    const hasher = createHash(\"sha1\");\n    const cacheName = hasher.update(id).digest(\"hex\");\n    return join(getHomeDir(), \".aws\", \"sso\", \"cache\", `${cacheName}.json`);\n};\n","import { ProviderError } from \"./ProviderError\";\nexport class TokenProviderError extends ProviderError {\n    name = \"TokenProviderError\";\n    constructor(message, options = true) {\n        super(message, options);\n        Object.setPrototypeOf(this, TokenProviderError.prototype);\n    }\n}\n","import { getConfigFilepath } from \"./getConfigFilepath\";\nimport { getSsoSessionData } from \"./getSsoSessionData\";\nimport { parseIni } from \"./parseIni\";\nimport { readFile } from \"./readFile\";\nconst swallowError = () => ({});\nexport const loadSsoSessionData = async (init = {}) => readFile(init.configFilepath ?? getConfigFilepath())\n    .then(parseIni)\n    .then(getSsoSessionData)\n    .catch(swallowError);\n","import { IniSectionType } from \"@smithy/types\";\nimport { CONFIG_PREFIX_SEPARATOR } from \"./loadSharedConfigFiles\";\nexport const getSsoSessionData = (data) => Object.entries(data)\n    .filter(([key]) => key.startsWith(IniSectionType.SSO_SESSION + CONFIG_PREFIX_SEPARATOR))\n    .reduce((acc, [key, value]) => ({ ...acc, [key.substring(key.indexOf(CONFIG_PREFIX_SEPARATOR) + 1)]: value }), {});\n","import { TokenProviderError } from \"@smithy/property-provider\";\nimport { getProfileName, getSSOTokenFromFile, loadSsoSessionData, parseKnownFiles, } from \"@smithy/shared-ini-file-loader\";\nimport { EXPIRE_WINDOW_MS, REFRESH_MESSAGE } from \"./constants\";\nimport { getNewSsoOidcToken } from \"./getNewSsoOidcToken\";\nimport { validateTokenExpiry } from \"./validateTokenExpiry\";\nimport { validateTokenKey } from \"./validateTokenKey\";\nimport { writeSSOTokenToFile } from \"./writeSSOTokenToFile\";\nconst lastRefreshAttemptTime = new Date(0);\nexport const fromSso = (_init = {}) => async ({ callerClientConfig } = {}) => {\n    const init = {\n        ..._init,\n        parentClientConfig: {\n            ...callerClientConfig,\n            ..._init.parentClientConfig,\n        },\n    };\n    init.logger?.debug(\"@aws-sdk/token-providers - fromSso\");\n    const profiles = await parseKnownFiles(init);\n    const profileName = getProfileName({\n        profile: init.profile ?? callerClientConfig?.profile,\n    });\n    const profile = profiles[profileName];\n    if (!profile) {\n        throw new TokenProviderError(`Profile '${profileName}' could not be found in shared credentials file.`, false);\n    }\n    else if (!profile[\"sso_session\"]) {\n        throw new TokenProviderError(`Profile '${profileName}' is missing required property 'sso_session'.`);\n    }\n    const ssoSessionName = profile[\"sso_session\"];\n    const ssoSessions = await loadSsoSessionData(init);\n    const ssoSession = ssoSessions[ssoSessionName];\n    if (!ssoSession) {\n        throw new TokenProviderError(`Sso session '${ssoSessionName}' could not be found in shared credentials file.`, false);\n    }\n    for (const ssoSessionRequiredKey of [\"sso_start_url\", \"sso_region\"]) {\n        if (!ssoSession[ssoSessionRequiredKey]) {\n            throw new TokenProviderError(`Sso session '${ssoSessionName}' is missing required property '${ssoSessionRequiredKey}'.`, false);\n        }\n    }\n    const ssoStartUrl = ssoSession[\"sso_start_url\"];\n    const ssoRegion = ssoSession[\"sso_region\"];\n    let ssoToken;\n    try {\n        ssoToken = await getSSOTokenFromFile(ssoSessionName);\n    }\n    catch (e) {\n        throw new TokenProviderError(`The SSO session token associated with profile=${profileName} was not found or is invalid. ${REFRESH_MESSAGE}`, false);\n    }\n    validateTokenKey(\"accessToken\", ssoToken.accessToken);\n    validateTokenKey(\"expiresAt\", ssoToken.expiresAt);\n    const { accessToken, expiresAt } = ssoToken;\n    const existingToken = { token: accessToken, expiration: new Date(expiresAt) };\n    if (existingToken.expiration.getTime() - Date.now() > EXPIRE_WINDOW_MS) {\n        return existingToken;\n    }\n    if (Date.now() - lastRefreshAttemptTime.getTime() < 30 * 1000) {\n        validateTokenExpiry(existingToken);\n        return existingToken;\n    }\n    validateTokenKey(\"clientId\", ssoToken.clientId, true);\n    validateTokenKey(\"clientSecret\", ssoToken.clientSecret, true);\n    validateTokenKey(\"refreshToken\", ssoToken.refreshToken, true);\n    try {\n        lastRefreshAttemptTime.setTime(Date.now());\n        const newSsoOidcToken = await getNewSsoOidcToken(ssoToken, ssoRegion, init);\n        validateTokenKey(\"accessToken\", newSsoOidcToken.accessToken);\n        validateTokenKey(\"expiresIn\", newSsoOidcToken.expiresIn);\n        const newTokenExpiration = new Date(Date.now() + newSsoOidcToken.expiresIn * 1000);\n        try {\n            await writeSSOTokenToFile(ssoSessionName, {\n                ...ssoToken,\n                accessToken: newSsoOidcToken.accessToken,\n                expiresAt: newTokenExpiration.toISOString(),\n                refreshToken: newSsoOidcToken.refreshToken,\n            });\n        }\n        catch (error) {\n        }\n        return {\n            token: newSsoOidcToken.accessToken,\n            expiration: newTokenExpiration,\n        };\n    }\n    catch (error) {\n        validateTokenExpiry(existingToken);\n        return existingToken;\n    }\n};\n","export const EXPIRE_WINDOW_MS = 5 * 60 * 1000;\nexport const REFRESH_MESSAGE = `To refresh this SSO session run 'aws sso login' with the corresponding profile.`;\n","export const getSsoOidcClient = async (ssoRegion, init = {}) => {\n    const { SSOOIDCClient } = await import(\"@aws-sdk/nested-clients/sso-oidc\");\n    const coalesce = (prop) => init.clientConfig?.[prop] ?? init.parentClientConfig?.[prop];\n    const ssoOidcClient = new SSOOIDCClient(Object.assign({}, init.clientConfig ?? {}, {\n        region: ssoRegion ?? init.clientConfig?.region,\n        logger: coalesce(\"logger\"),\n        userAgentAppId: coalesce(\"userAgentAppId\"),\n    }));\n    return ssoOidcClient;\n};\n","import { getSsoOidcClient } from \"./getSsoOidcClient\";\nexport const getNewSsoOidcToken = async (ssoToken, ssoRegion, init = {}) => {\n    const { CreateTokenCommand } = await import(\"@aws-sdk/nested-clients/sso-oidc\");\n    const ssoOidcClient = await getSsoOidcClient(ssoRegion, init);\n    return ssoOidcClient.send(new CreateTokenCommand({\n        clientId: ssoToken.clientId,\n        clientSecret: ssoToken.clientSecret,\n        refreshToken: ssoToken.refreshToken,\n        grantType: \"refresh_token\",\n    }));\n};\n","import { TokenProviderError } from \"@smithy/property-provider\";\nimport { REFRESH_MESSAGE } from \"./constants\";\nexport const validateTokenExpiry = (token) => {\n    if (token.expiration && token.expiration.getTime() < Date.now()) {\n        throw new TokenProviderError(`Token is expired. ${REFRESH_MESSAGE}`, false);\n    }\n};\n","import { TokenProviderError } from \"@smithy/property-provider\";\nimport { REFRESH_MESSAGE } from \"./constants\";\nexport const validateTokenKey = (key, value, forRefresh = false) => {\n    if (typeof value === \"undefined\") {\n        throw new TokenProviderError(`Value not present for '${key}' in SSO Token${forRefresh ? \". Cannot refresh\" : \"\"}. ${REFRESH_MESSAGE}`, false);\n    }\n};\n","import { getSSOTokenFilepath } from \"@smithy/shared-ini-file-loader\";\nimport { promises as fsPromises } from \"fs\";\nconst { writeFile } = fsPromises;\nexport const writeSSOTokenToFile = (id, ssoToken) => {\n    const tokenFilepath = getSSOTokenFilepath(id);\n    const tokenString = JSON.stringify(ssoToken, null, 2);\n    return writeFile(tokenFilepath, tokenString);\n};\n","import { setCredentialFeature } from \"@aws-sdk/core/client\";\nimport { CredentialsProviderError } from \"@smithy/property-provider\";\nexport const ENV_KEY = \"AWS_ACCESS_KEY_ID\";\nexport const ENV_SECRET = \"AWS_SECRET_ACCESS_KEY\";\nexport const ENV_SESSION = \"AWS_SESSION_TOKEN\";\nexport const ENV_EXPIRATION = \"AWS_CREDENTIAL_EXPIRATION\";\nexport const ENV_CREDENTIAL_SCOPE = \"AWS_CREDENTIAL_SCOPE\";\nexport const ENV_ACCOUNT_ID = \"AWS_ACCOUNT_ID\";\nexport const fromEnv = (init) => async () => {\n    init?.logger?.debug(\"@aws-sdk/credential-provider-env - fromEnv\");\n    const accessKeyId = process.env[ENV_KEY];\n    const secretAccessKey = process.env[ENV_SECRET];\n    const sessionToken = process.env[ENV_SESSION];\n    const expiry = process.env[ENV_EXPIRATION];\n    const credentialScope = process.env[ENV_CREDENTIAL_SCOPE];\n    const accountId = process.env[ENV_ACCOUNT_ID];\n    if (accessKeyId && secretAccessKey) {\n        const credentials = {\n            accessKeyId,\n            secretAccessKey,\n            ...(sessionToken && { sessionToken }),\n            ...(expiry && { expiration: new Date(expiry) }),\n            ...(credentialScope && { credentialScope }),\n            ...(accountId && { accountId }),\n        };\n        setCredentialFeature(credentials, \"CREDENTIALS_ENV_VARS\", \"g\");\n        return credentials;\n    }\n    throw new CredentialsProviderError(\"Unable to find environment variable credentials.\", { logger: init?.logger });\n};\n","import { NormalizedSchema } from \"@smithy/core/schema\";\nimport { HttpRequest } from \"@smithy/protocol-http\";\nimport { collectBody } from \"./collect-stream-body\";\nimport { HttpProtocol } from \"./HttpProtocol\";\nexport class RpcProtocol extends HttpProtocol {\n    async serializeRequest(operationSchema, input, context) {\n        const serializer = this.serializer;\n        const query = {};\n        const headers = {};\n        const endpoint = await context.endpoint();\n        const ns = NormalizedSchema.of(operationSchema?.input);\n        const schema = ns.getSchema();\n        let payload;\n        const request = new HttpRequest({\n            protocol: \"\",\n            hostname: \"\",\n            port: undefined,\n            path: \"/\",\n            fragment: undefined,\n            query: query,\n            headers: headers,\n            body: undefined,\n        });\n        if (endpoint) {\n            this.updateServiceEndpoint(request, endpoint);\n            this.setHostPrefix(request, operationSchema, input);\n        }\n        const _input = {\n            ...input,\n        };\n        if (input) {\n            const eventStreamMember = ns.getEventStreamMember();\n            if (eventStreamMember) {\n                if (_input[eventStreamMember]) {\n                    const initialRequest = {};\n                    for (const [memberName, memberSchema] of ns.structIterator()) {\n                        if (memberName !== eventStreamMember && _input[memberName]) {\n                            serializer.write(memberSchema, _input[memberName]);\n                            initialRequest[memberName] = serializer.flush();\n                        }\n                    }\n                    payload = await this.serializeEventStream({\n                        eventStream: _input[eventStreamMember],\n                        requestSchema: ns,\n                        initialRequest,\n                    });\n                }\n            }\n            else {\n                serializer.write(schema, _input);\n                payload = serializer.flush();\n            }\n        }\n        request.headers = headers;\n        request.query = query;\n        request.body = payload;\n        request.method = \"POST\";\n        return request;\n    }\n    async deserializeResponse(operationSchema, context, response) {\n        const deserializer = this.deserializer;\n        const ns = NormalizedSchema.of(operationSchema.output);\n        const dataObject = {};\n        if (response.statusCode >= 300) {\n            const bytes = await collectBody(response.body, context);\n            if (bytes.byteLength > 0) {\n                Object.assign(dataObject, await deserializer.read(15, bytes));\n            }\n            await this.handleError(operationSchema, context, response, dataObject, this.deserializeMetadata(response));\n            throw new Error(\"@smithy/core/protocols - RPC Protocol error handler failed to throw.\");\n        }\n        for (const header in response.headers) {\n            const value = response.headers[header];\n            delete response.headers[header];\n            response.headers[header.toLowerCase()] = value;\n        }\n        const eventStreamMember = ns.getEventStreamMember();\n        if (eventStreamMember) {\n            dataObject[eventStreamMember] = await this.deserializeEventStream({\n                response,\n                responseSchema: ns,\n                initialResponseContainer: dataObject,\n            });\n        }\n        else {\n            const bytes = await collectBody(response.body, context);\n            if (bytes.byteLength > 0) {\n                Object.assign(dataObject, await deserializer.read(ns, bytes));\n            }\n        }\n        dataObject.$metadata = this.deserializeMetadata(response);\n        return dataObject;\n    }\n}\n","/**\n * SSM Configuration Loader for BG-Remover Service\n *\n * Loads configuration and secrets from AWS SSM Parameter Store\n * following CarouselLabs multi-tenant patterns.\n */\n\nimport { SSMClient, GetParameterCommand } from '@aws-sdk/client-ssm';\nimport type { ServiceConfig, ServiceSecrets } from '../types';\n\nconst ssmClient = new SSMClient({\n  region: process.env.AWS_REGION || 'eu-west-1',\n});\n\n// Cache for configuration\nlet configCache: ServiceConfig | null = null;\nlet secretsCache: ServiceSecrets | null = null;\nlet cacheExpiry = 0;\nconst CACHE_TTL_MS = 5 * 60 * 1000; // 5 minutes\n\n/**\n * Get SSM parameter value\n */\nasync function getParameter(name: string, decrypt = false): Promise<string | null> {\n  try {\n    const response = await ssmClient.send(\n      new GetParameterCommand({\n        Name: name,\n        WithDecryption: decrypt,\n      })\n    );\n    return response.Parameter?.Value || null;\n  } catch (error) {\n    console.error(`Failed to get SSM parameter ${name}:`, error);\n    return null;\n  }\n}\n\n/**\n * Load service configuration from SSM\n */\nexport async function loadConfig(\n  tenant: string = 'carousel-labs',\n  stage: string = process.env.STAGE || 'dev'\n): Promise<ServiceConfig> {\n  // Return cached config if still valid\n  if (configCache && Date.now() < cacheExpiry) {\n    return configCache;\n  }\n\n  const configPath = `/tf/${stage}/${tenant}/services/bg-remover/config`;\n  const configJson = await getParameter(configPath);\n\n  if (configJson) {\n    try {\n      configCache = JSON.parse(configJson) as ServiceConfig;\n      cacheExpiry = Date.now() + CACHE_TTL_MS;\n      return configCache;\n    } catch (error) {\n      console.error('Failed to parse config JSON:', error);\n    }\n  }\n\n  // Return default configuration if SSM parameter not found\n  const defaultConfig: ServiceConfig = {\n    bedrock: {\n      modelId: 'anthropic.claude-3-5-sonnet-20241022-v2:0',\n      region: 'us-east-1', // Bedrock region\n      maxTokens: 4096,\n    },\n    s3: {\n      inputBucket: `smartgo-s3tables-${stage}-${tenant}`,\n      outputBucket: `bg-remover-${stage}-${tenant}-output`,\n      region: 'eu-west-1',\n    },\n    processing: {\n      maxImageSizeMb: 10,\n      supportedFormats: ['jpg', 'jpeg', 'png', 'webp', 'heic'],\n      defaultQuality: 95,\n    },\n  };\n\n  configCache = defaultConfig;\n  cacheExpiry = Date.now() + CACHE_TTL_MS;\n  return defaultConfig;\n}\n\n/**\n * Load service secrets from SSM\n */\nexport async function loadSecrets(\n  tenant: string = 'carousel-labs',\n  stage: string = process.env.STAGE || 'dev'\n): Promise<ServiceSecrets> {\n  // Return cached secrets if still valid\n  if (secretsCache && Date.now() < cacheExpiry) {\n    return secretsCache;\n  }\n\n  const secretsPath = `/tf/${stage}/${tenant}/services/bg-remover/secrets`;\n  const secretsJson = await getParameter(secretsPath, true);\n\n  if (secretsJson) {\n    try {\n      secretsCache = JSON.parse(secretsJson) as ServiceSecrets;\n      return secretsCache;\n    } catch (error) {\n      console.error('Failed to parse secrets JSON:', error);\n    }\n  }\n\n  // Return empty secrets if not found\n  secretsCache = {};\n  return secretsCache;\n}\n\n/**\n * Load both config and secrets\n */\nexport async function loadConfigAndSecrets(\n  tenant: string = 'carousel-labs',\n  stage: string = process.env.STAGE || 'dev'\n): Promise<{ config: ServiceConfig; secrets: ServiceSecrets }> {\n  const [config, secrets] = await Promise.all([\n    loadConfig(tenant, stage),\n    loadSecrets(tenant, stage),\n  ]);\n\n  return { config, secrets };\n}\n\n/**\n * Clear configuration cache (useful for testing)\n */\nexport function clearCache(): void {\n  configCache = null;\n  secretsCache = null;\n  cacheExpiry = 0;\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]}