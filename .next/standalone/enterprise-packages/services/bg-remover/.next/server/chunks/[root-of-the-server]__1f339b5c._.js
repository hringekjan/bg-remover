module.exports=[71815,(e,t,r)=>{t.exports=e.x("sharp",()=>require("sharp"))},13829,e=>{e.v({name:"@aws-sdk/client-bedrock-runtime",description:"AWS SDK for JavaScript Bedrock Runtime Client for Node.js, Browser and React Native",version:"3.946.0",scripts:{build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-bedrock-runtime","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo bedrock-runtime","test:index":"tsc --noEmit ./test/index-types.ts && node ./test/index-objects.spec.mjs"},main:"./dist-cjs/index.js",types:"./dist-types/index.d.ts",module:"./dist-es/index.js",sideEffects:!1,dependencies:{"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/core":"3.946.0","@aws-sdk/credential-provider-node":"3.946.0","@aws-sdk/eventstream-handler-node":"3.936.0","@aws-sdk/middleware-eventstream":"3.936.0","@aws-sdk/middleware-host-header":"3.936.0","@aws-sdk/middleware-logger":"3.936.0","@aws-sdk/middleware-recursion-detection":"3.936.0","@aws-sdk/middleware-user-agent":"3.946.0","@aws-sdk/middleware-websocket":"3.936.0","@aws-sdk/region-config-resolver":"3.936.0","@aws-sdk/token-providers":"3.946.0","@aws-sdk/types":"3.936.0","@aws-sdk/util-endpoints":"3.936.0","@aws-sdk/util-user-agent-browser":"3.936.0","@aws-sdk/util-user-agent-node":"3.946.0","@smithy/config-resolver":"^4.4.3","@smithy/core":"^3.18.7","@smithy/eventstream-serde-browser":"^4.2.5","@smithy/eventstream-serde-config-resolver":"^4.3.5","@smithy/eventstream-serde-node":"^4.2.5","@smithy/fetch-http-handler":"^5.3.6","@smithy/hash-node":"^4.2.5","@smithy/invalid-dependency":"^4.2.5","@smithy/middleware-content-length":"^4.2.5","@smithy/middleware-endpoint":"^4.3.14","@smithy/middleware-retry":"^4.4.14","@smithy/middleware-serde":"^4.2.6","@smithy/middleware-stack":"^4.2.5","@smithy/node-config-provider":"^4.3.5","@smithy/node-http-handler":"^4.4.5","@smithy/protocol-http":"^5.3.5","@smithy/smithy-client":"^4.9.10","@smithy/types":"^4.9.0","@smithy/url-parser":"^4.2.5","@smithy/util-base64":"^4.3.0","@smithy/util-body-length-browser":"^4.2.0","@smithy/util-body-length-node":"^4.2.1","@smithy/util-defaults-mode-browser":"^4.3.13","@smithy/util-defaults-mode-node":"^4.2.16","@smithy/util-endpoints":"^3.2.5","@smithy/util-middleware":"^4.2.5","@smithy/util-retry":"^4.2.5","@smithy/util-stream":"^4.5.6","@smithy/util-utf8":"^4.2.0",tslib:"^2.6.2"},devDependencies:{"@tsconfig/node18":"18.2.4","@types/node":"^18.19.69",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~5.8.3"},engines:{node:">=18.0.0"},typesVersions:{"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},files:["dist-*/**"],author:{name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},license:"Apache-2.0",browser:{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:"https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-bedrock-runtime",repository:{type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-bedrock-runtime"}})},25328,(e,t,r)=>{t.exports=e.x("http2",()=>require("http2"))},80736,81732,83692,e=>{"use strict";var t,r,n=e.i(14992);let i=n.z.object({imageUrl:n.z.string().url().optional(),imageBase64:n.z.string().optional(),outputFormat:n.z.enum(["png","webp","jpeg"]).default("png"),quality:n.z.number().min(1).max(100).default(95),tenant:n.z.string().default("carousel-labs"),productId:n.z.string().optional(),callbackUrl:n.z.string().url().optional(),autoTrim:n.z.boolean().default(!0),centerSubject:n.z.boolean().default(!0),enhanceColors:n.z.boolean().default(!0),targetWidth:n.z.number().positive().optional(),targetHeight:n.z.number().positive().optional(),generateDescription:n.z.boolean().default(!1),productName:n.z.string().optional()}).refine(e=>e.imageUrl||e.imageBase64,{message:"Either imageUrl or imageBase64 must be provided"}),o=n.z.object({images:n.z.array(n.z.object({url:n.z.string().url().optional(),base64:n.z.string().optional(),productId:n.z.string().optional(),metadata:n.z.record(n.z.string()).optional()}).refine(e=>e.url||e.base64,{message:"Either url or base64 must be provided for each image"})).min(1).max(100),tenant:n.z.string().default("carousel-labs"),outputFormat:n.z.enum(["png","webp","jpeg"]).default("png"),quality:n.z.number().min(1).max(100).default(95),concurrency:n.z.number().min(1).max(10).default(3),callbackUrl:n.z.string().url().optional()});e.s(["BatchRequestSchema",0,o,"ProcessRequestSchema",0,i],80736);var a=e.i(71815),s=e.i(54799),c=e.i(36422),d=e.i(16315),l=e.i(500),u=e.i(40490),g=e.i(73779),f=e.i(240);class p{signer;constructor(e){this.signer=e.signer}presign(e,t={}){return this.signer.presign(e,t)}async sign(e,t){return f.HttpRequest.isInstance(e)&&("ws:"===e.protocol||"wss:"===e.protocol)?{...await this.signer.presign({...e,body:""},{...t,expiresIn:60,unsignableHeaders:new Set(Object.keys(e.headers).filter(e=>"host"!==e))}),body:e.body}:this.signer.sign(e,t)}}var m=e.i(87362),h=e.i(85548),y=e.i(55539),b=e.i(70017),x=e.i(77270),v=e.i(39397),w=e.i(98859),S=e.i(39645),k=e.i(88710),C=e.i(40462),E=e.i(493),P=e.i(71150),A=e.i(81826),R=e.i(27822);let T=async(e,t,r)=>({operation:(0,A.getSmithyContext)(t).operation,region:await (0,R.normalizeProvider)(e.region)()||(()=>{throw Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),I=e=>{let t=[];return e.operation,t.push({schemeId:"aws.auth#sigv4",signingProperties:{name:"bedrock",region:e.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}),t.push({schemeId:"smithy.api#httpBearerAuth",propertiesExtractor:({profile:e,filepath:t,configFilepath:r,ignoreCache:n},i)=>({identityProperties:{profile:e,filepath:t,configFilepath:r,ignoreCache:n}})}),t},O={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};var U=e.i(13829),B=e.i(69502),D=e.i(77941),M=e.i(19110),G=e.i(40313),$=("function"==typeof SuppressedError&&SuppressedError,e.i(874)),F="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>{let t=((e,t)=>{if("string"!=typeof e)throw TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?$.Buffer.from(e,t):$.Buffer.from(e)})(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)};function N(){this.crc32=new L}N.prototype.update=function(e){("string"==typeof e?0===e.length:0===e.byteLength)||this.crc32.update(e instanceof Uint8Array?e:"string"==typeof e?F(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e))},N.prototype.digest=function(){var e,t,r,n;return e=this,t=void 0,r=void 0,n=function(){return function(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){var d=[s,c];if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&d[0]?n.return:d[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,d[1])).done)return i;switch(n=0,i&&(d=[2&d[0],i.value]),d[0]){case 0:case 1:i=d;break;case 4:return o.label++,{value:d[1],done:!1};case 5:o.label++,n=d[1],d=[0];continue;case 7:d=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===d[0]||2===d[0])){o=0;continue}if(3===d[0]&&(!i||d[1]>i[0]&&d[1]<i[3])){o.label=d[1];break}if(6===d[0]&&o.label<i[1]){o.label=i[1],i=d;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(d);break}i[2]&&o.ops.pop(),o.trys.pop();continue}d=t.call(e,o)}catch(e){d=[6,e],n=0}finally{r=i=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}}(this,function(e){var t;return[2,new Uint8Array([(0xff000000&(t=this.crc32.digest()))>>24,(0xff0000&t)>>16,(65280&t)>>8,255&t])]})},new(r||(r=Promise))(function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},N.prototype.reset=function(){this.crc32=new L};var L=function(){function e(){this.checksum=0xffffffff}return e.prototype.update=function(e){var t,r;try{for(var n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),i=n.next();!i.done;i=n.next()){var o=i.value;this.checksum=this.checksum>>>8^z[(this.checksum^o)&255]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(0xffffffff^this.checksum)>>>0},e}(),z=function(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),r=0;r<e.length;)t[r]=e[r],r+=1;return t}return Uint32Array.from(e)}([0,0x77073096,0xee0e612c,0x990951ba,0x76dc419,0x706af48f,0xe963a535,0x9e6495a3,0xedb8832,0x79dcb8a4,0xe0d5e91e,0x97d2d988,0x9b64c2b,0x7eb17cbd,0xe7b82d07,0x90bf1d91,0x1db71064,0x6ab020f2,0xf3b97148,0x84be41de,0x1adad47d,0x6ddde4eb,0xf4d4b551,0x83d385c7,0x136c9856,0x646ba8c0,0xfd62f97a,0x8a65c9ec,0x14015c4f,0x63066cd9,0xfa0f3d63,0x8d080df5,0x3b6e20c8,0x4c69105e,0xd56041e4,0xa2677172,0x3c03e4d1,0x4b04d447,0xd20d85fd,0xa50ab56b,0x35b5a8fa,0x42b2986c,0xdbbbc9d6,0xacbcf940,0x32d86ce3,0x45df5c75,0xdcd60dcf,0xabd13d59,0x26d930ac,0x51de003a,0xc8d75180,0xbfd06116,0x21b4f4b5,0x56b3c423,0xcfba9599,0xb8bda50f,0x2802b89e,0x5f058808,0xc60cd9b2,0xb10be924,0x2f6f7c87,0x58684c11,0xc1611dab,0xb6662d3d,0x76dc4190,0x1db7106,0x98d220bc,0xefd5102a,0x71b18589,0x6b6b51f,0x9fbfe4a5,0xe8b8d433,0x7807c9a2,0xf00f934,0x9609a88e,0xe10e9818,0x7f6a0dbb,0x86d3d2d,0x91646c97,0xe6635c01,0x6b6b51f4,0x1c6c6162,0x856530d8,0xf262004e,0x6c0695ed,0x1b01a57b,0x8208f4c1,0xf50fc457,0x65b0d9c6,0x12b7e950,0x8bbeb8ea,0xfcb9887c,0x62dd1ddf,0x15da2d49,0x8cd37cf3,0xfbd44c65,0x4db26158,0x3ab551ce,0xa3bc0074,0xd4bb30e2,0x4adfa541,0x3dd895d7,0xa4d1c46d,0xd3d6f4fb,0x4369e96a,0x346ed9fc,0xad678846,0xda60b8d0,0x44042d73,0x33031de5,0xaa0a4c5f,0xdd0d7cc9,0x5005713c,0x270241aa,0xbe0b1010,0xc90c2086,0x5768b525,0x206f85b3,0xb966d409,0xce61e49f,0x5edef90e,0x29d9c998,0xb0d09822,0xc7d7a8b4,0x59b33d17,0x2eb40d81,0xb7bd5c3b,0xc0ba6cad,0xedb88320,0x9abfb3b6,0x3b6e20c,0x74b1d29a,0xead54739,0x9dd277af,0x4db2615,0x73dc1683,0xe3630b12,0x94643b84,0xd6d6a3e,0x7a6a5aa8,0xe40ecf0b,0x9309ff9d,0xa00ae27,0x7d079eb1,0xf00f9344,0x8708a3d2,0x1e01f268,0x6906c2fe,0xf762575d,0x806567cb,0x196c3671,0x6e6b06e7,0xfed41b76,0x89d32be0,0x10da7a5a,0x67dd4acc,0xf9b9df6f,0x8ebeeff9,0x17b7be43,0x60b08ed5,0xd6d6a3e8,0xa1d1937e,0x38d8c2c4,0x4fdff252,0xd1bb67f1,0xa6bc5767,0x3fb506dd,0x48b2364b,0xd80d2bda,0xaf0a1b4c,0x36034af6,0x41047a60,0xdf60efc3,0xa867df55,0x316e8eef,0x4669be79,0xcb61b38c,0xbc66831a,0x256fd2a0,0x5268e236,0xcc0c7795,0xbb0b4703,0x220216b9,0x5505262f,0xc5ba3bbe,0xb2bd0b28,0x2bb45a92,0x5cb36a04,0xc2d7ffa7,0xb5d0cf31,0x2cd99e8b,0x5bdeae1d,0x9b64c2b0,0xec63f226,0x756aa39c,0x26d930a,0x9c0906a9,0xeb0e363f,0x72076785,0x5005713,0x95bf4a82,0xe2b87a14,0x7bb12bae,0xcb61b38,0x92d28e9b,0xe5d5be0d,0x7cdcefb7,0xbdbdf21,0x86d3d2d4,0xf1d4e242,0x68ddb3f8,0x1fda836e,0x81be16cd,0xf6b9265b,0x6fb077e1,0x18b74777,0x88085ae6,0xff0f6a70,0x66063bca,0x11010b5c,0x8f659eff,0xf862ae69,0x616bffd3,0x166ccf45,0xa00ae278,0xd70dd2ee,0x4e048354,0x3903b3c2,0xa7672661,0xd06016f7,0x4969474d,0x3e6e77db,0xaed16a4a,0xd9d65adc,0x40df0b66,936918e3,0xa9bcae53,0xdebb9ec5,0x47b2cf7f,0x30b5ffe9,0xbdbdf21c,0xcabac28a,0x53b39330,0x24b4a3a6,0xbad03605,0xcdd70693,0x54de5729,0x23d967bf,0xb3667a2e,0xc4614ab8,0x5d681b02,0x2a6f2b94,0xb40bbe37,0xc30c8ea1,0x5a05df1b,0x2d02ef8d]),j=e.i(31290);class _{bytes;constructor(e){if(this.bytes=e,8!==e.byteLength)throw Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);let t=new Uint8Array(8);for(let r=7,n=Math.abs(Math.round(e));r>-1&&n>0;r--,n/=256)t[r]=n;return e<0&&q(t),new _(t)}valueOf(){let e=this.bytes.slice(0),t=128&e[0];return t&&q(e),parseInt((0,j.toHex)(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function q(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}class H{toUtf8;fromUtf8;constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){let t=[];for(let r of Object.keys(e)){let n=this.fromUtf8(r);t.push(Uint8Array.from([n.byteLength]),n,this.formatHeaderValue(e[r]))}let r=new Uint8Array(t.reduce((e,t)=>e+t.byteLength,0)),n=0;for(let e of t)r.set(e,n),n+=e.byteLength;return r}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([+!e.value]);case"byte":return Uint8Array.from([2,e.value]);case"short":let t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":let r=new DataView(new ArrayBuffer(5));return r.setUint8(0,4),r.setInt32(1,e.value,!1),new Uint8Array(r.buffer);case"long":let n=new Uint8Array(9);return n[0]=5,n.set(e.value.bytes,1),n;case"binary":let i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);let o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":let a=this.fromUtf8(e.value),s=new DataView(new ArrayBuffer(3+a.byteLength));s.setUint8(0,7),s.setUint16(1,a.byteLength,!1);let c=new Uint8Array(s.buffer);return c.set(a,3),c;case"timestamp":let d=new Uint8Array(9);return d[0]=8,d.set(_.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!et.test(e.value))throw Error(`Invalid UUID received: ${e.value}`);let l=new Uint8Array(17);return l[0]=9,l.set((0,j.fromHex)(e.value.replace(/\-/g,"")),1),l}}parse(e){let t={},r=0;for(;r<e.byteLength;){let n=e.getUint8(r++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,n));switch(r+=n,e.getUint8(r++)){case 0:t[i]={type:V,value:!0};break;case 1:t[i]={type:V,value:!1};break;case 2:t[i]={type:W,value:e.getInt8(r++)};break;case 3:t[i]={type:J,value:e.getInt16(r,!1)},r+=2;break;case 4:t[i]={type:K,value:e.getInt32(r,!1)},r+=4;break;case 5:t[i]={type:X,value:new _(new Uint8Array(e.buffer,e.byteOffset+r,8))},r+=8;break;case 6:let o=e.getUint16(r,!1);r+=2,t[i]={type:Y,value:new Uint8Array(e.buffer,e.byteOffset+r,o)},r+=o;break;case 7:let a=e.getUint16(r,!1);r+=2,t[i]={type:Q,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+r,a))},r+=a;break;case 8:t[i]={type:Z,value:new Date(new _(new Uint8Array(e.buffer,e.byteOffset+r,8)).valueOf())},r+=8;break;case 9:let s=new Uint8Array(e.buffer,e.byteOffset+r,16);r+=16,t[i]={type:ee,value:`${(0,j.toHex)(s.subarray(0,4))}-${(0,j.toHex)(s.subarray(4,6))}-${(0,j.toHex)(s.subarray(6,8))}-${(0,j.toHex)(s.subarray(8,10))}-${(0,j.toHex)(s.subarray(10))}`};break;default:throw Error("Unrecognized header type tag")}}return t}}(t=r||(r={}))[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid";let V="boolean",W="byte",J="short",K="integer",X="long",Y="binary",Q="string",Z="timestamp",ee="uuid",et=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,er=16;class en{headerMarshaller;messageBuffer;isEndOfStream;constructor(e,t){this.headerMarshaller=new H(e,t),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){let e=this.messageBuffer.pop(),t=this.isEndOfStream;return{getMessage:()=>e,isEndOfStream:()=>t}}getAvailableMessages(){let e=this.messageBuffer;this.messageBuffer=[];let t=this.isEndOfStream;return{getMessages:()=>e,isEndOfStream:()=>t}}encode({headers:e,body:t}){let r=this.headerMarshaller.format(e),n=r.byteLength+t.byteLength+16,i=new Uint8Array(n),o=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new L;return o.setUint32(0,n,!1),o.setUint32(4,r.byteLength,!1),o.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(r,12),i.set(t,r.byteLength+12),o.setUint32(n-4,a.update(i.subarray(8,n-4)).digest(),!1),i}decode(e){let{headers:t,body:r}=function({byteLength:e,byteOffset:t,buffer:r}){if(e<er)throw Error("Provided message too short to accommodate event stream message overhead");let n=new DataView(r,t,e),i=n.getUint32(0,!1);if(e!==i)throw Error("Reported message length does not match received message length");let o=n.getUint32(4,!1),a=n.getUint32(8,!1),s=n.getUint32(e-4,!1),c=new L().update(new Uint8Array(r,t,8));if(a!==c.digest())throw Error(`The prelude checksum specified in the message (${a}) does not match the calculated CRC32 checksum (${c.digest()})`);if(c.update(new Uint8Array(r,t+8,e-12)),s!==c.digest())throw Error(`The message checksum (${c.digest()}) did not match the expected value of ${s}`);return{headers:new DataView(r,t+8+4,o),body:new Uint8Array(r,t+8+4+o,i-o-16)}}(e);return{headers:this.headerMarshaller.parse(t),body:r}}formatHeaders(e){return this.headerMarshaller.format(e)}}var ei=e.i(88947),eo=ei;class ea extends eo.Transform{priorSignature;messageSigner;eventStreamCodec;systemClockOffsetProvider;constructor(e){super({autoDestroy:!0,readableObjectMode:!0,writableObjectMode:!0,...e}),this.priorSignature=e.priorSignature,this.eventStreamCodec=e.eventStreamCodec,this.messageSigner=e.messageSigner,this.systemClockOffsetProvider=e.systemClockOffsetProvider}async _transform(e,t,r){try{var n;let t,i=new Date(Date.now()+await this.systemClockOffsetProvider()),o={":date":{type:"timestamp",value:i}},a=await this.messageSigner.sign({message:{body:e,headers:o},priorSignature:this.priorSignature},{signingDate:i});this.priorSignature=a.signature;let s=this.eventStreamCodec.encode({headers:{...o,":chunk-signature":{type:"binary",value:(n=a.signature,t=Buffer.from(n,"hex"),new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT))}},body:e});return this.push(s),r()}catch(e){r(e)}}}class es{messageSigner;eventStreamCodec;systemClockOffsetProvider;constructor(e){this.messageSigner=e.messageSigner,this.eventStreamCodec=new en(e.utf8Encoder,e.utf8Decoder),this.systemClockOffsetProvider=async()=>e.systemClockOffset??0}async handle(e,t,r={}){let n,i=t.request,{body:o,query:a}=i;if(!(o instanceof ei.Readable))throw Error("Eventstream payload must be a Readable stream.");i.body=new ei.PassThrough({objectMode:!0});let s=i.headers?.authorization?.match(/Signature=([\w]+)$/),c=new ea({priorSignature:s?.[1]??a?.["X-Amz-Signature"]??"",eventStreamCodec:this.eventStreamCodec,messageSigner:await this.messageSigner(),systemClockOffsetProvider:this.systemClockOffsetProvider});(0,ei.pipeline)(o,c,i.body,e=>{if(e)throw e});try{n=await e(t)}catch(e){throw i.body.end(),e}return n}}let ec=e=>new es(e);var ed=e.i(62917),el=e.i(77335),eu=e.i(64279),eg=e.i(52821),ef=e.i(7992),ep=e.i(5075),em=e.i(3180),eh=e.i(48016),ey=e.i(41514),eb=e.i(43735);class ex{async sign(e,t,r){let n=f.HttpRequest.clone(e);if(!t.token)throw Error("request could not be signed with `token` since the `token` is not defined");return n.headers.Authorization=`Bearer ${t.token}`,n}}class ev{options;constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async *asyncIterator(){for await(let e of this.options.inputStream){let t=this.options.decoder.decode(e);yield t}}}class ew{options;constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async *asyncIterator(){for await(let e of this.options.messageStream){let t=this.options.encoder.encode(e);yield t}this.options.includeEndFrame&&(yield new Uint8Array(0))}}class eS{options;constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async *asyncIterator(){for await(let e of this.options.messageStream){let t=await this.options.deserializer(e);void 0!==t&&(yield t)}}}class ek{options;constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async *asyncIterator(){for await(let e of this.options.inputStream){let t=this.options.serializer(e);yield t}}}class eC{eventStreamCodec;utfEncoder;constructor({utf8Encoder:e,utf8Decoder:t}){this.eventStreamCodec=new en(e,t),this.utfEncoder=e}deserialize(e,t){var r;let n,i,o,a,s;return new eS({messageStream:new ev({inputStream:(n=0,i=0,o=null,a=null,s=e=>{if("number"!=typeof e)throw Error("Attempted to allocate an event message where size was not a number: "+e);n=e,i=4,new DataView((o=new Uint8Array(e)).buffer).setUint32(0,e,!1)},{[Symbol.asyncIterator]:async function*(){let t=e[Symbol.asyncIterator]();for(;;){let{value:e,done:r}=await t.next();if(r){if(n)if(n===i)yield o;else throw Error("Truncated event message received.");return}let c=e.length,d=0;for(;d<c;){if(!o){let t=c-d;a||(a=new Uint8Array(4));let r=Math.min(4-i,t);if(a.set(e.slice(d,d+r),i),i+=r,d+=r,i<4)break;s(new DataView(a.buffer).getUint32(0,!1)),a=null}let t=Math.min(n-i,c-d);o.set(e.slice(d,d+t),i),i+=t,d+=t,n&&n===i&&(yield o,o=null,n=0,i=0)}}}}),decoder:this.eventStreamCodec}),deserializer:(r=this.utfEncoder,async function(e){let{value:n}=e.headers[":message-type"];if("error"===n){let t=Error(e.headers[":error-message"].value||"UnknownError");throw t.name=e.headers[":error-code"].value,t}if("exception"===n){let n=e.headers[":exception-type"].value,i=await t({[n]:e});if(i.$unknown){let t=Error(r(e.body));throw t.name=n,t}throw i[n]}if("event"===n){let r={[e.headers[":event-type"].value]:e},n=await t(r);if(n.$unknown)return;return n}throw Error(`Unrecognizable event type: ${e.headers[":event-type"].value}`)})})}serialize(e,t){return new ew({messageStream:new ek({inputStream:e,serializer:t}),encoder:this.eventStreamCodec,includeEndFrame:!0})}}async function*eE(e){let t=!1,r=!1,n=[];for(e.on("error",e=>{if(t||(t=!0),e)throw e}),e.on("data",e=>{n.push(e)}),e.on("end",()=>{t=!0});!r;){let e=await new Promise(e=>setTimeout(()=>e(n.shift()),0));e&&(yield e),r=t&&0===n.length}}class eP{universalMarshaller;constructor({utf8Encoder:e,utf8Decoder:t}){this.universalMarshaller=new eC({utf8Decoder:t,utf8Encoder:e})}deserialize(e,t){let r="function"==typeof e[Symbol.asyncIterator]?e:eE(e);return this.universalMarshaller.deserialize(r,t)}serialize(e,t){return ei.Readable.from(this.universalMarshaller.serialize(e,t))}}let eA=e=>new eP(e);var eR=e.i(80491),eT=e.i(32660),eI=e.i(46434),eO=e.i(63480),eU=e.i(25328),eB=e.i(55208);class eD{sessions=[];constructor(e){this.sessions=e??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(e){this.sessions.push(e)}contains(e){return this.sessions.includes(e)}remove(e){this.sessions=this.sessions.filter(t=>t!==e)}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(e){for(let t of this.sessions)t!==e||t.destroyed||t.destroy()}}class eM{constructor(e){if(this.config=e,this.config.maxConcurrency&&this.config.maxConcurrency<=0)throw RangeError("maxConcurrency must be greater than zero.")}config;sessionCache=new Map;lease(e,t){let r=this.getUrlString(e),n=this.sessionCache.get(r);if(n){let e=n.poll();if(e&&!this.config.disableConcurrency)return e}let i=eU.default.connect(r);this.config.maxConcurrency&&i.settings({maxConcurrentStreams:this.config.maxConcurrency},t=>{if(t)throw Error("Fail to set maxConcurrentStreams to "+this.config.maxConcurrency+"when creating new session for "+e.destination.toString())}),i.unref();let o=()=>{i.destroy(),this.deleteSession(r,i)};i.on("goaway",o),i.on("error",o),i.on("frameError",o),i.on("close",()=>this.deleteSession(r,i)),t.requestTimeout&&i.setTimeout(t.requestTimeout,o);let a=this.sessionCache.get(r)||new eD;return a.offerLast(i),this.sessionCache.set(r,a),i}deleteSession(e,t){let r=this.sessionCache.get(e);!r||r.contains(t)&&(r.remove(t),this.sessionCache.set(e,r))}release(e,t){let r=this.getUrlString(e);this.sessionCache.get(r)?.offerLast(t)}destroy(){for(let[e,t]of this.sessionCache){for(let e of t)e.destroyed||e.destroy(),t.remove(e);this.sessionCache.delete(e)}}setMaxConcurrentStreams(e){if(e&&e<=0)throw RangeError("maxConcurrentStreams must be greater than zero.");this.config.maxConcurrency=e}setDisableConcurrentStreams(e){this.config.disableConcurrency=e}getUrlString(e){return e.destination.toString()}}var eG=e.i(44886);class e${config;configProvider;metadata={handlerProtocol:"h2"};connectionManager=new eM({});static create(e){return"function"==typeof e?.handle?e:new e$(e)}constructor(e){this.configProvider=new Promise((t,r)=>{"function"==typeof e?e().then(e=>{t(e||{})}).catch(r):t(e||{})})}destroy(){this.connectionManager.destroy()}async handle(e,{abortSignal:t,requestTimeout:r}={}){!this.config&&(this.config=await this.configProvider,this.connectionManager.setDisableConcurrentStreams(this.config.disableConcurrentStreams||!1),this.config.maxConcurrentStreams&&this.connectionManager.setMaxConcurrentStreams(this.config.maxConcurrentStreams));let{requestTimeout:n,disableConcurrentStreams:i}=this.config,o=r??n;return new Promise((r,n)=>{let a,s=!1,c=async e=>{await a,r(e)},d=async e=>{await a,n(e)};if(t?.aborted){s=!0;let e=Error("Request aborted");e.name="AbortError",d(e);return}let{hostname:l,method:u,port:g,protocol:f,query:p}=e,m="";if(null!=e.username||null!=e.password){let t=e.username??"",r=e.password??"";m=`${t}:${r}@`}let h=`${f}//${m}${l}${g?`:${g}`:""}`,y={destination:new URL(h)},b=this.connectionManager.lease(y,{requestTimeout:this.config?.sessionTimeout,disableConcurrentStreams:i||!1}),x=e=>{i&&this.destroySession(b),s=!0,d(e)},v=(0,eO.buildQueryString)(p||{}),w=e.path;v&&(w+=`?${v}`),e.fragment&&(w+=`#${e.fragment}`);let S=b.request({...e.headers,[eU.constants.HTTP2_HEADER_PATH]:w,[eU.constants.HTTP2_HEADER_METHOD]:u});if(b.ref(),S.on("response",e=>{let t=new eI.HttpResponse({statusCode:e[":status"]||-1,headers:(0,eB.getTransformedHeaders)(e),body:S});s=!0,c({response:t}),i&&(b.close(),this.connectionManager.deleteSession(h,b))}),o&&S.setTimeout(o,()=>{S.close();let e=Error(`Stream timed out because of no activity for ${o} ms`);e.name="TimeoutError",x(e)}),t){let e=()=>{S.close();let e=Error("Request aborted");e.name="AbortError",x(e)};"function"==typeof t.addEventListener?(t.addEventListener("abort",e,{once:!0}),S.once("close",()=>t.removeEventListener("abort",e))):t.onabort=e}S.on("frameError",(e,t,r)=>{x(Error(`Frame type id ${e} in stream id ${r} has failed with code ${t}.`))}),S.on("error",x),S.on("aborted",()=>{x(Error(`HTTP/2 stream is abnormally aborted in mid-communication with result code ${S.rstCode}.`))}),S.on("close",()=>{b.unref(),i&&b.destroy(),s||x(Error("Unexpected error: http2 request did not get a response"))}),a=(0,eG.writeRequestBody)(S,e,o)})}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then(r=>({...r,[e]:t}))}httpHandlerConfigs(){return this.config??{}}destroySession(e){e.destroyed||e.destroy()}}var eF=e.i(79935),eN=e.i(24511),eL=e.i(64576),ez=e.i(95153),ej=e.i(4224),e_=e.i(69183),eq=e.i(80168),eH=e.i(36841),eV=e.i(19991),eW=e.i(29596),eJ=e.i(78228),eK=e.i(56719),eX=e.i(23241);e.i(76738);var eY=e.i(83733),eQ=e.i(77075),eZ=e.i(49536),e0=e.i(98796);let e3="required",e1="argv",e4="isSet",e2="booleanEquals",e6="error",e8="endpoint",e5="tree",e9="PartitionResult",e7={[e3]:!1,type:"string"},te={[e3]:!0,default:!1,type:"boolean"},tt={ref:"Endpoint"},tr={fn:e2,[e1]:[{ref:"UseFIPS"},!0]},tn={fn:e2,[e1]:[{ref:"UseDualStack"},!0]},ti={},to={fn:"getAttr",[e1]:[{ref:e9},"supportsFIPS"]},ta={fn:e2,[e1]:[!0,{fn:"getAttr",[e1]:[{ref:e9},"supportsDualStack"]}]},ts=[tr],tc=[tn],td=[{ref:"Region"}],tl={version:"1.0",parameters:{Region:e7,UseDualStack:te,UseFIPS:te,Endpoint:e7},rules:[{conditions:[{fn:e4,[e1]:[tt]}],rules:[{conditions:ts,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:e6},{rules:[{conditions:tc,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:e6},{endpoint:{url:tt,properties:ti,headers:ti},type:e8}],type:e5}],type:e5},{rules:[{conditions:[{fn:e4,[e1]:td}],rules:[{conditions:[{fn:"aws.partition",[e1]:td,assign:e9}],rules:[{conditions:[tr,tn],rules:[{conditions:[{fn:e2,[e1]:[!0,to]},ta],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ti,headers:ti},type:e8}],type:e5}],type:e5},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:e6}],type:e5},{conditions:ts,rules:[{conditions:[{fn:e2,[e1]:[to,!0]}],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:ti,headers:ti},type:e8}],type:e5}],type:e5},{error:"FIPS is enabled but this partition does not support FIPS",type:e6}],type:e5},{conditions:tc,rules:[{conditions:[ta],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ti,headers:ti},type:e8}],type:e5}],type:e5},{error:"DualStack is enabled but this partition does not support DualStack",type:e6}],type:e5},{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dnsSuffix}",properties:ti,headers:ti},type:e8}],type:e5}],type:e5}],type:e5},{error:"Invalid Configuration: Missing Region",type:e6}],type:e5}]},tu=new eZ.EndpointCache({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),tg=(e,t={})=>tu.get(e,()=>(0,e0.resolveEndpoint)(tl,{endpointParams:e,logger:t.logger}));eQ.customEndpointFunctions.aws=eY.awsEndpointFunctions;var tf=e.i(69967),tp=e.i(16845),tm=e.i(78195);class th extends C.Client{config;constructor(...[e]){const t=(e=>{(0,eN.emitWarningIfUnsupportedVersion)(process.version);let t=(0,ej.resolveDefaultsModeConfig)(e),r=()=>t().then(eL.loadConfigsForDefaultMode),n={apiVersion:"2023-09-30",base64Decoder:e?.base64Decoder??eW.fromBase64,base64Encoder:e?.base64Encoder??eJ.toBase64,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??tg,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??I,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new B.AwsSdkSigV4Signer},{schemeId:"smithy.api#httpBearerAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#httpBearerAuth"),signer:new ex}],logger:e?.logger??new eH.NoOpLogger,protocol:e?.protocol??new eq.AwsRestJsonProtocol({defaultNamespace:"com.amazonaws.bedrockruntime"}),serviceId:e?.serviceId??"Bedrock Runtime",urlParser:e?.urlParser??eV.parseUrl,utf8Decoder:e?.utf8Decoder??eK.fromUtf8,utf8Encoder:e?.utf8Encoder??eX.toUtf8};(0,M.emitWarningIfUnsupportedVersion)(process.version);let i={profile:e?.profile,logger:n.logger,signingName:"bedrock"};return{...n,...e,runtime:"node",defaultsMode:t,authSchemePreference:e?.authSchemePreference??(0,eT.loadConfig)(D.NODE_AUTH_SCHEME_PREFERENCE_OPTIONS,i),bodyLengthChecker:e?.bodyLengthChecker??ez.calculateBodyLength,credentialDefaultProvider:e?.credentialDefaultProvider??G.defaultProvider,defaultUserAgentProvider:e?.defaultUserAgentProvider??(0,em.createDefaultUserAgentProvider)({serviceId:n.serviceId,clientVersion:U.default.version}),eventStreamPayloadHandlerProvider:e?.eventStreamPayloadHandlerProvider??ec,eventStreamSerdeProvider:e?.eventStreamSerdeProvider??eA,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new B.AwsSdkSigV4Signer},{schemeId:"smithy.api#httpBearerAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#httpBearerAuth")||(async e=>{try{return await (({logger:e,signingName:t}={})=>async()=>{if(e?.debug?.("@aws-sdk/token-providers - fromEnvSigningName"),!t)throw new el.TokenProviderError("Please pass 'signingName' to compute environment variable key",{logger:e});let r=(0,ed.getBearerTokenEnvKey)(t);if(!(r in process.env))throw new el.TokenProviderError(`Token not present in '${r}' environment variable`,{logger:e});let n={token:process.env[r]};return n.$source||(n.$source={}),n.$source.BEARER_SERVICE_ENV_VARS="3",n})({signingName:"bedrock"})()}catch(t){return await ((e={})=>(0,eg.memoize)((0,eu.chain)((0,ef.fromSso)(e),async()=>{throw new el.TokenProviderError("Could not load token from any providers",!1)}),e=>void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5,e=>void 0!==e.expiration))(e)(e)}}),signer:new ex}],maxAttempts:e?.maxAttempts??(0,eT.loadConfig)(k.NODE_MAX_ATTEMPT_CONFIG_OPTIONS,e),region:e?.region??(0,eT.loadConfig)(eh.NODE_REGION_CONFIG_OPTIONS,{...eh.NODE_REGION_CONFIG_FILE_OPTIONS,...i}),requestHandler:e$.create(e?.requestHandler??(async()=>({...await r(),disableConcurrentStreams:!0}))),retryMode:e?.retryMode??(0,eT.loadConfig)({...k.NODE_RETRY_MODE_CONFIG_OPTIONS,default:async()=>(await r()).retryMode||e_.DEFAULT_RETRY_MODE},e),sha256:e?.sha256??eR.Hash.bind(null,"sha256"),streamCollector:e?.streamCollector??eF.streamCollector,useDualstackEndpoint:e?.useDualstackEndpoint??(0,eT.loadConfig)(ey.NODE_USE_DUALSTACK_ENDPOINT_CONFIG_OPTIONS,i),useFipsEndpoint:e?.useFipsEndpoint??(0,eT.loadConfig)(eb.NODE_USE_FIPS_ENDPOINT_CONFIG_OPTIONS,i),userAgentAppId:e?.userAgentAppId??(0,eT.loadConfig)(ep.NODE_APP_ID_CONFIG_OPTIONS,i)}})(e||{});super(t),this.initConfig=t;const r=(e=>Object.assign(e,{useDualstackEndpoint:e.useDualstackEndpoint??!1,useFipsEndpoint:e.useFipsEndpoint??!1,defaultSigningName:"bedrock"}))(t),n=(0,g.resolveUserAgentConfig)(r),i=(0,k.resolveRetryConfig)(n),o=(0,m.resolveRegionConfig)(i),a=(0,c.resolveHostHeaderConfig)(o),s=((e,t)=>{let r,n,i,o,a=Object.assign((0,tf.getAwsRegionExtensionConfiguration)(e),(0,tm.getDefaultExtensionConfiguration)(e),(0,tp.getHttpHandlerExtensionConfiguration)(e),(r=e.httpAuthSchemes,n=e.httpAuthSchemeProvider,i=e.credentials,o=e.token,{setHttpAuthScheme(e){let t=r.findIndex(t=>t.schemeId===e.schemeId);-1===t?r.push(e):r.splice(t,1,e)},httpAuthSchemes:()=>r,setHttpAuthSchemeProvider(e){n=e},httpAuthSchemeProvider:()=>n,setCredentials(e){i=e},credentials:()=>i,setToken(e){o=e},token:()=>o}));return t.forEach(e=>e.configure(a)),Object.assign(e,(0,tf.resolveAwsRegionExtensionConfiguration)(a),(0,tm.resolveDefaultRuntimeConfig)(a),(0,tp.resolveHttpHandlerRuntimeConfig)(a),{httpAuthSchemes:a.httpAuthSchemes(),httpAuthSchemeProvider:a.httpAuthSchemeProvider(),credentials:a.credentials(),token:a.token()})})((e=>{let{signer:t}=e;return Object.assign(e,{signer:async e=>{let r=await t(e);if(r)return new p({signer:r});throw Error("Expected WebsocketSignatureV4 signer, please check the client constructor.")}})})(function(e){let t=e.signer,r=e.signer,n=Object.assign(e,{eventSigner:t,messageSigner:r}),i=n.eventStreamPayloadHandlerProvider(n);return Object.assign(n,{eventStreamPayloadHandler:i})}((e=>{let t=(0,P.memoizeIdentityProvider)(e.token,P.isIdentityExpired,P.doesIdentityRequireRefresh);return Object.assign((0,E.resolveAwsSdkSigV4Config)(e),{authSchemePreference:(0,R.normalizeProvider)(e.authSchemePreference??[]),token:t})})((e=>Object.assign(e,{eventStreamMarshaller:e.eventStreamSerdeProvider(e)}))((0,w.resolveEndpointConfig)(a))))),e?.extensions||[]);this.config=s,this.middlewareStack.use((0,x.getSchemaSerdePlugin)(this.config)),this.middlewareStack.use((0,u.getUserAgentPlugin)(this.config)),this.middlewareStack.use((0,S.getRetryPlugin)(this.config)),this.middlewareStack.use((0,v.getContentLengthPlugin)(this.config)),this.middlewareStack.use((0,c.getHostHeaderPlugin)(this.config)),this.middlewareStack.use((0,d.getLoggerPlugin)(this.config)),this.middlewareStack.use((0,l.getRecursionDetectionPlugin)(this.config)),this.middlewareStack.use((0,y.getHttpAuthSchemeEndpointRuleSetPlugin)(this.config,{httpAuthSchemeParametersProvider:T,identityProviderConfigProvider:async e=>new h.DefaultIdentityProviderConfig({"aws.auth#sigv4":e.credentials,"smithy.api#httpBearerAuth":e.token})})),this.middlewareStack.use((0,b.getHttpSigningPlugin)(this.config))}destroy(){super.destroy()}}var ty=e.i(20231),tb=e.i(22830),tx=e.i(18526),tv=e.i(72232);class tw extends tv.ServiceException{constructor(e){super(e),Object.setPrototypeOf(this,tw.prototype)}}class tS extends tw{name="AccessDeniedException";$fault="client";constructor(e){super({name:"AccessDeniedException",$fault:"client",...e}),Object.setPrototypeOf(this,tS.prototype)}}class tk extends tw{name="InternalServerException";$fault="server";constructor(e){super({name:"InternalServerException",$fault:"server",...e}),Object.setPrototypeOf(this,tk.prototype)}}class tC extends tw{name="ThrottlingException";$fault="client";constructor(e){super({name:"ThrottlingException",$fault:"client",...e}),Object.setPrototypeOf(this,tC.prototype)}}class tE extends tw{name="ValidationException";$fault="client";constructor(e){super({name:"ValidationException",$fault:"client",...e}),Object.setPrototypeOf(this,tE.prototype)}}class tP extends tw{name="ConflictException";$fault="client";constructor(e){super({name:"ConflictException",$fault:"client",...e}),Object.setPrototypeOf(this,tP.prototype)}}class tA extends tw{name="ResourceNotFoundException";$fault="client";constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),Object.setPrototypeOf(this,tA.prototype)}}class tR extends tw{name="ServiceQuotaExceededException";$fault="client";constructor(e){super({name:"ServiceQuotaExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,tR.prototype)}}class tT extends tw{name="ServiceUnavailableException";$fault="server";constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),Object.setPrototypeOf(this,tT.prototype)}}class tI extends tw{name="ModelErrorException";$fault="client";originalStatusCode;resourceName;constructor(e){super({name:"ModelErrorException",$fault:"client",...e}),Object.setPrototypeOf(this,tI.prototype),this.originalStatusCode=e.originalStatusCode,this.resourceName=e.resourceName}}class tO extends tw{name="ModelNotReadyException";$fault="client";$retryable={};constructor(e){super({name:"ModelNotReadyException",$fault:"client",...e}),Object.setPrototypeOf(this,tO.prototype)}}class tU extends tw{name="ModelTimeoutException";$fault="client";constructor(e){super({name:"ModelTimeoutException",$fault:"client",...e}),Object.setPrototypeOf(this,tU.prototype)}}class tB extends tw{name="ModelStreamErrorException";$fault="client";originalStatusCode;originalMessage;constructor(e){super({name:"ModelStreamErrorException",$fault:"client",...e}),Object.setPrototypeOf(this,tB.prototype),this.originalStatusCode=e.originalStatusCode,this.originalMessage=e.originalMessage}}let tD="Content-Type",tM="X-Amzn-Bedrock-PerformanceConfig-Latency",tG="X-Amzn-Bedrock-Service-Tier",t$="action",tF="bytes",tN="bucketOwner",tL="body",tz="client",tj="contentBlockIndex",t_="cachePoint",tq="contradictingRules",tH="contentType",tV="claimsTrueScenario",tW="citations",tJ="claims",tK="content",tX="confidence",tY="documentIndex",tQ="detected",tZ="document",t0="error",t3="format",t1="filters",t4="guardrail",t2="guardContent",t6="guardrailIdentifier",t8="guardrailVersion",t5="guarded",t9="httpError",t7="httpHeader",re="input",rt="image",rr="json",rn="location",ri="latencyMs",ro="logicWarning",ra="message",rs="match",rc="name",rd="originalStatusCode",rl="premises",ru="performanceConfigLatency",rg="promptRouter",rf="qualifiers",rp="reasoningContent",rm="redactedContent",rh="role",ry="source",rb="sourceContent",rx="s3Location",rv="searchResult",rw="serviceTier",rS="server",rk="signature",rC="smithy.ts.sdk.synthetic.com.amazonaws.bedrockruntime",rE="status",rP="start",rA="type",rR="toolResult",rT="toolUse",rI="toolUseId",rO="text",rU="title",rB="total",rD="trace",rM="translation",rG="usage",r$="video",rF="com.amazonaws.bedrockruntime";var rN=[0,rF,"AsyncInvokeMessage",8,0],rL=[0,rF,"Body",8,21],rz=[0,rF,"GuardrailAutomatedReasoningStatementLogicContent",8,0],rj=[0,rF,"GuardrailAutomatedReasoningStatementNaturalLanguageContent",8,0],r_=[0,rF,"PartBody",8,21],rq=[-3,rF,"AccessDeniedException",{[t0]:tz,[t9]:403},[ra],[0]];tx.TypeRegistry.for(rF).registerError(rq,tS);var rH=[3,rF,"AnyToolChoice",0,[],[]],rV=[3,rF,"AppliedGuardrailDetails",0,["guardrailId",t8,"guardrailArn","guardrailOrigin","guardrailOwnership"],[0,0,0,64,0]],rW=[3,rF,"AsyncInvokeS3OutputDataConfig",0,["s3Uri","kmsKeyId",tN],[0,0,0]],rJ=[3,rF,"AsyncInvokeSummary",0,["invocationArn","modelArn","clientRequestToken",rE,"failureMessage","submitTime","lastModifiedTime","endTime","outputDataConfig"],[0,0,0,0,[()=>rN,0],5,5,5,()=>i1]],rK=[3,rF,"AudioBlock",0,[t3,ry,t0],[0,[()=>i4,0],[()=>ns,0]]],rX=[3,rF,"AutoToolChoice",0,[],[]],rY=[3,rF,"BidirectionalInputPayloadPart",8,[tF],[[()=>r_,0]]],rQ=[3,rF,"BidirectionalOutputPayloadPart",8,[tF],[[()=>r_,0]]],rZ=[3,rF,"CachePointBlock",0,[rA],[0]],r0=[3,rF,"Citation",0,[rU,ry,rb,rn],[0,0,()=>iT,()=>i6]],r3=[3,rF,"CitationsConfig",0,["enabled"],[2]],r1=[3,rF,"CitationsContentBlock",0,[tK,tW],[()=>iA,()=>iR]],r4=[3,rF,"CitationsDelta",0,[rU,ry,rb,rn],[0,0,()=>iI,()=>i6]],r2=[3,rF,"CitationSourceContentDelta",0,[rO],[0]],r6=[-3,rF,"ConflictException",{[t0]:tz,[t9]:400},[ra],[0]];tx.TypeRegistry.for(rF).registerError(r6,tP);var r8=[3,rF,"ContentBlockDeltaEvent",0,["delta",tj],[[()=>i9,0],1]],r5=[3,rF,"ContentBlockStartEvent",0,[rP,tj],[()=>i7,1]],r9=[3,rF,"ContentBlockStopEvent",0,[tj],[1]],r7=[3,rF,"ConverseStreamMetadataEvent",0,[rG,"metrics",rD,"performanceConfig",rw],[()=>im,()=>ne,[()=>nt,0],()=>n9,()=>ic]],ne=[3,rF,"ConverseStreamMetrics",0,[ri],[1]],nt=[3,rF,"ConverseStreamTrace",0,[t4,rg],[[()=>nq,0],()=>n7]],nr=[3,rF,"ConverseTokensRequest",0,["messages","system","toolConfig","additionalModelRequestFields"],[[()=>iJ,0],[()=>iX,0],()=>ih,15]],nn=[3,rF,"DocumentBlock",0,[t3,rc,ry,"context",tW],[0,0,()=>ot,0,()=>r3]],ni=[3,rF,"DocumentCharLocation",0,[tY,rP,"end"],[1,1,1]],no=[3,rF,"DocumentChunkLocation",0,[tY,rP,"end"],[1,1,1]],na=[3,rF,"DocumentPageLocation",0,[tY,rP,"end"],[1,1,1]],ns=[3,rF,"ErrorBlock",8,[ra],[0]],nc=[3,rF,"GuardrailAssessment",0,["topicPolicy","contentPolicy","wordPolicy","sensitiveInformationPolicy","contextualGroundingPolicy","automatedReasoningPolicy","invocationMetrics","appliedGuardrailDetails"],[()=>n_,()=>nE,()=>nV,()=>nN,()=>nA,[()=>np,0],()=>nD,()=>rV]],nd=[3,rF,"GuardrailAutomatedReasoningImpossibleFinding",0,[rM,tq,ro],[[()=>nv,0],()=>i$,[()=>ng,0]]],nl=[3,rF,"GuardrailAutomatedReasoningInputTextReference",0,[rO],[[()=>rj,0]]],nu=[3,rF,"GuardrailAutomatedReasoningInvalidFinding",0,[rM,tq,ro],[[()=>nv,0],()=>i$,[()=>ng,0]]],ng=[3,rF,"GuardrailAutomatedReasoningLogicWarning",0,[rA,rl,tJ],[0,[()=>iF,0],[()=>iF,0]]],nf=[3,rF,"GuardrailAutomatedReasoningNoTranslationsFinding",0,[],[]],np=[3,rF,"GuardrailAutomatedReasoningPolicyAssessment",0,["findings"],[[()=>iM,0]]],nm=[3,rF,"GuardrailAutomatedReasoningRule",0,["identifier","policyVersionArn"],[0,0]],nh=[3,rF,"GuardrailAutomatedReasoningSatisfiableFinding",0,[rM,tV,"claimsFalseScenario",ro],[[()=>nv,0],[()=>ny,0],[()=>ny,0],[()=>ng,0]]],ny=[3,rF,"GuardrailAutomatedReasoningScenario",0,["statements"],[[()=>iF,0]]],nb=[3,rF,"GuardrailAutomatedReasoningStatement",0,["logic","naturalLanguage"],[[()=>rz,0],[()=>rj,0]]],nx=[3,rF,"GuardrailAutomatedReasoningTooComplexFinding",0,[],[]],nv=[3,rF,"GuardrailAutomatedReasoningTranslation",0,[rl,tJ,"untranslatedPremises","untranslatedClaims",tX],[[()=>iF,0],[()=>iF,0],[()=>iG,0],[()=>iG,0],1]],nw=[3,rF,"GuardrailAutomatedReasoningTranslationAmbiguousFinding",0,["options","differenceScenarios"],[[()=>iL,0],[()=>iD,0]]],nS=[3,rF,"GuardrailAutomatedReasoningTranslationOption",0,["translations"],[[()=>iN,0]]],nk=[3,rF,"GuardrailAutomatedReasoningValidFinding",0,[rM,tV,"supportingRules",ro],[[()=>nv,0],[()=>ny,0],()=>i$,[()=>ng,0]]],nC=[3,rF,"GuardrailContentFilter",0,[rA,tX,"filterStrength",t$,tQ],[0,0,0,0,2]],nE=[3,rF,"GuardrailContentPolicyAssessment",0,[t1],[()=>iz]],nP=[3,rF,"GuardrailContextualGroundingFilter",0,[rA,"threshold","score",t$,tQ],[0,1,1,0,2]],nA=[3,rF,"GuardrailContextualGroundingPolicyAssessment",0,[t1],[()=>ij]],nR=[3,rF,"GuardrailConverseImageBlock",8,[t3,ry],[0,[()=>oo,0]]],nT=[3,rF,"GuardrailConverseTextBlock",0,[rO,rf],[0,64]],nI=[3,rF,"GuardrailCoverage",0,["textCharacters","images"],[()=>nz,()=>nB]],nO=[3,rF,"GuardrailCustomWord",0,[rs,t$,tQ],[0,0,2]],nU=[3,rF,"GuardrailImageBlock",8,[t3,ry],[0,[()=>oa,0]]],nB=[3,rF,"GuardrailImageCoverage",0,[t5,rB],[1,1]],nD=[3,rF,"GuardrailInvocationMetrics",0,["guardrailProcessingLatency",rG,"guardrailCoverage"],[1,()=>nH,()=>nI]],nM=[3,rF,"GuardrailManagedWord",0,[rs,rA,t$,tQ],[0,0,0,2]],nG=[3,rF,"GuardrailOutputContent",0,[rO],[0]],n$=[3,rF,"GuardrailPiiEntityFilter",0,[rs,rA,t$,tQ],[0,0,0,2]],nF=[3,rF,"GuardrailRegexFilter",0,[rc,rs,"regex",t$,tQ],[0,0,0,0,2]],nN=[3,rF,"GuardrailSensitiveInformationPolicyAssessment",0,["piiEntities","regexes"],[()=>iH,()=>iV]],nL=[3,rF,"GuardrailTextBlock",0,[rO,rf],[0,64]],nz=[3,rF,"GuardrailTextCharactersCoverage",0,[t5,rB],[1,1]],nj=[3,rF,"GuardrailTopic",0,[rc,rA,t$,tQ],[0,0,0,2]],n_=[3,rF,"GuardrailTopicPolicyAssessment",0,["topics"],[()=>iW]],nq=[3,rF,"GuardrailTraceAssessment",0,["modelOutput","inputAssessment","outputAssessments","actionReason"],[64,[()=>i3,0],[()=>i0,0],0]],nH=[3,rF,"GuardrailUsage",0,["topicPolicyUnits","contentPolicyUnits","wordPolicyUnits","sensitiveInformationPolicyUnits","sensitiveInformationPolicyFreeUnits","contextualGroundingPolicyUnits","contentPolicyImageUnits","automatedReasoningPolicyUnits","automatedReasoningPolicies"],[1,1,1,1,1,1,1,1,1]],nV=[3,rF,"GuardrailWordPolicyAssessment",0,["customWords","managedWordLists"],[()=>i_,()=>iq]],nW=[3,rF,"ImageBlock",0,[t3,ry,t0],[0,[()=>os,0],[()=>ns,0]]],nJ=[3,rF,"ImageBlockDelta",0,[ry,t0],[[()=>os,0],[()=>ns,0]]],nK=[3,rF,"ImageBlockStart",0,[t3],[0]],nX=[-3,rF,"InternalServerException",{[t0]:rS,[t9]:500},[ra],[0]];tx.TypeRegistry.for(rF).registerError(nX,tk);var nY=[3,rF,"InvokeModelRequest",0,[tL,tH,"accept","modelId",rD,t6,t8,ru,rw],[[()=>rL,16],[0,{[t7]:tD}],[0,{[t7]:"Accept"}],[0,1],[0,{[t7]:"X-Amzn-Bedrock-Trace"}],[0,{[t7]:"X-Amzn-Bedrock-GuardrailIdentifier"}],[0,{[t7]:"X-Amzn-Bedrock-GuardrailVersion"}],[0,{[t7]:tM}],[0,{[t7]:tG}]]],nQ=[3,rF,"InvokeModelResponse",0,[tL,tH,ru,rw],[[()=>rL,16],[0,{[t7]:tD}],[0,{[t7]:tM}],[0,{[t7]:tG}]]],nZ=[3,rF,"InvokeModelTokensRequest",0,[tL],[[()=>rL,0]]],n0=[3,rF,"Message",0,[rh,tK],[0,[()=>iO,0]]],n3=[3,rF,"MessageStartEvent",0,[rh],[0]],n1=[3,rF,"MessageStopEvent",0,["stopReason","additionalModelResponseFields"],[0,15]],n4=[-3,rF,"ModelErrorException",{[t0]:tz,[t9]:424},[ra,rd,"resourceName"],[0,1,0]];tx.TypeRegistry.for(rF).registerError(n4,tI);var n2=[-3,rF,"ModelNotReadyException",{[t0]:tz,[t9]:429},[ra],[0]];tx.TypeRegistry.for(rF).registerError(n2,tO);var n6=[-3,rF,"ModelStreamErrorException",{[t0]:tz,[t9]:424},[ra,rd,"originalMessage"],[0,1,0]];tx.TypeRegistry.for(rF).registerError(n6,tB);var n8=[-3,rF,"ModelTimeoutException",{[t0]:tz,[t9]:408},[ra],[0]];tx.TypeRegistry.for(rF).registerError(n8,tU);var n5=[3,rF,"PayloadPart",8,[tF],[[()=>r_,0]]],n9=[3,rF,"PerformanceConfiguration",0,["latency"],[0]],n7=[3,rF,"PromptRouterTrace",0,["invokedModelId"],[0]],ie=[3,rF,"ReasoningTextBlock",8,[rO,rk],[0,0]],it=[-3,rF,"ResourceNotFoundException",{[t0]:tz,[t9]:404},[ra],[0]];tx.TypeRegistry.for(rF).registerError(it,tA);var ir=[3,rF,"S3Location",0,["uri",tN],[0,0]],ii=[3,rF,"SearchResultBlock",0,[ry,rU,tK,tW],[0,0,()=>iK,()=>r3]],io=[3,rF,"SearchResultContentBlock",0,[rO],[0]],ia=[3,rF,"SearchResultLocation",0,["searchResultIndex",rP,"end"],[1,1,1]],is=[-3,rF,"ServiceQuotaExceededException",{[t0]:tz,[t9]:400},[ra],[0]];tx.TypeRegistry.for(rF).registerError(is,tR);var ic=[3,rF,"ServiceTier",0,[rA],[0]],id=[-3,rF,"ServiceUnavailableException",{[t0]:rS,[t9]:503},[ra],[0]];tx.TypeRegistry.for(rF).registerError(id,tT);var il=[3,rF,"SpecificToolChoice",0,[rc],[0]],iu=[3,rF,"SystemTool",0,[rc],[0]],ig=[3,rF,"Tag",0,["key","value"],[0,0]],ip=[-3,rF,"ThrottlingException",{[t0]:tz,[t9]:429},[ra],[0]];tx.TypeRegistry.for(rF).registerError(ip,tC);var im=[3,rF,"TokenUsage",0,["inputTokens","outputTokens","totalTokens","cacheReadInputTokens","cacheWriteInputTokens"],[1,1,1,1,1]],ih=[3,rF,"ToolConfiguration",0,["tools","toolChoice"],[()=>iZ,()=>of]],iy=[3,rF,"ToolResultBlock",0,[rI,tK,rE,rA],[0,[()=>iQ,0],0,0]],ib=[3,rF,"ToolResultBlockStart",0,[rI,rA,rE],[0,0,0]],ix=[3,rF,"ToolSpecification",0,[rc,"description","inputSchema"],[0,0,()=>op]],iv=[3,rF,"ToolUseBlock",0,[rI,rc,re,rA],[0,0,15,0]],iw=[3,rF,"ToolUseBlockDelta",0,[re],[0]],iS=[3,rF,"ToolUseBlockStart",0,[rI,rc,rA],[0,0,0]],ik=[-3,rF,"ValidationException",{[t0]:tz,[t9]:400},[ra],[0]];tx.TypeRegistry.for(rF).registerError(ik,tE);var iC=[3,rF,"VideoBlock",0,[t3,ry],[0,()=>oy]],iE=[3,rF,"WebLocation",0,["url","domain"],[0,0]],iP=[-3,rC,"BedrockRuntimeServiceException",0,[],[]];tx.TypeRegistry.for(rC).registerError(iP,tw);var iA=[1,rF,"CitationGeneratedContentList",0,()=>i2],iR=[1,rF,"Citations",0,()=>r0],iT=[1,rF,"CitationSourceContentList",0,()=>i8],iI=[1,rF,"CitationSourceContentListDelta",0,()=>r2],iO=[1,rF,"ContentBlocks",0,[()=>i5,0]],iU=[1,rF,"DocumentContentBlocks",0,()=>oe],iB=[1,rF,"GuardrailAssessmentList",0,[()=>nc,0]],iD=[1,rF,"GuardrailAutomatedReasoningDifferenceScenarioList",0,[()=>ny,0]],iM=[1,rF,"GuardrailAutomatedReasoningFindingList",0,[()=>or,0]],iG=[1,rF,"GuardrailAutomatedReasoningInputTextReferenceList",0,[()=>nl,0]],i$=[1,rF,"GuardrailAutomatedReasoningRuleList",0,()=>nm],iF=[1,rF,"GuardrailAutomatedReasoningStatementList",0,[()=>nb,0]],iN=[1,rF,"GuardrailAutomatedReasoningTranslationList",0,[()=>nv,0]],iL=[1,rF,"GuardrailAutomatedReasoningTranslationOptionList",0,[()=>nS,0]],iz=[1,rF,"GuardrailContentFilterList",0,()=>nC],ij=[1,rF,"GuardrailContextualGroundingFilters",0,()=>nP],i_=[1,rF,"GuardrailCustomWordList",0,()=>nO],iq=[1,rF,"GuardrailManagedWordList",0,()=>nM],iH=[1,rF,"GuardrailPiiEntityFilterList",0,()=>n$],iV=[1,rF,"GuardrailRegexFilterList",0,()=>nF],iW=[1,rF,"GuardrailTopicList",0,()=>nj],iJ=[1,rF,"Messages",0,[()=>n0,0]],iK=[1,rF,"SearchResultContentBlocks",0,()=>io],iX=[1,rF,"SystemContentBlocks",0,[()=>ou,0]],iY=[1,rF,"ToolResultBlocksDelta",0,()=>om],iQ=[1,rF,"ToolResultContentBlocks",0,[()=>oh,0]],iZ=[1,rF,"Tools",0,()=>og],i0=[2,rF,"GuardrailAssessmentListMap",0,[0,0],[()=>iB,0]],i3=[2,rF,"GuardrailAssessmentMap",0,[0,0],[()=>nc,0]],i1=[3,rF,"AsyncInvokeOutputDataConfig",0,["s3OutputDataConfig"],[()=>rW]],i4=[3,rF,"AudioSource",8,[tF,rx],[21,()=>ir]],i2=[3,rF,"CitationGeneratedContent",0,[rO],[0]],i6=[3,rF,"CitationLocation",0,["web","documentChar","documentPage","documentChunk","searchResultLocation"],[()=>iE,()=>ni,()=>na,()=>no,()=>ia]],i8=[3,rF,"CitationSourceContent",0,[rO],[0]],i5=[3,rF,"ContentBlock",0,[rO,rt,tZ,r$,"audio",rT,rR,t2,t_,rp,"citationsContent",rv],[0,[()=>nW,0],()=>nn,()=>iC,[()=>rK,0],()=>iv,[()=>iy,0],[()=>oi,0],()=>rZ,[()=>od,0],()=>r1,()=>ii]],i9=[3,rF,"ContentBlockDelta",0,[rO,rT,rR,rp,"citation",rt],[0,()=>iw,()=>iY,[()=>ol,0],()=>r4,[()=>nJ,0]]],i7=[3,rF,"ContentBlockStart",0,[rT,rR,rt],[()=>iS,()=>ib,()=>nK]],oe=[3,rF,"DocumentContentBlock",0,[rO],[0]],ot=[3,rF,"DocumentSource",0,[tF,rx,rO,tK],[21,()=>ir,0,()=>iU]],or=[3,rF,"GuardrailAutomatedReasoningFinding",0,["valid","invalid","satisfiable","impossible","translationAmbiguous","tooComplex","noTranslations"],[[()=>nk,0],[()=>nu,0],[()=>nh,0],[()=>nd,0],[()=>nw,0],()=>nx,()=>nf]],on=[3,rF,"GuardrailContentBlock",0,[rO,rt],[()=>nL,[()=>nU,0]]],oi=[3,rF,"GuardrailConverseContentBlock",0,[rO,rt],[()=>nT,[()=>nR,0]]],oo=[3,rF,"GuardrailConverseImageSource",8,[tF],[21]],oa=[3,rF,"GuardrailImageSource",8,[tF],[21]],os=[3,rF,"ImageSource",8,[tF,rx],[21,()=>ir]],oc=[3,rF,"PromptVariableValues",0,[rO],[0]],od=[3,rF,"ReasoningContentBlock",8,["reasoningText",rm],[[()=>ie,0],21]],ol=[3,rF,"ReasoningContentBlockDelta",8,[rO,rm,rk],[0,21,0]],ou=[3,rF,"SystemContentBlock",0,[rO,t2,t_],[0,[()=>oi,0],()=>rZ]],og=[3,rF,"Tool",0,["toolSpec","systemTool",t_],[()=>ix,()=>iu,()=>rZ]],of=[3,rF,"ToolChoice",0,["auto","any","tool"],[()=>rX,()=>rH,()=>il]],op=[3,rF,"ToolInputSchema",0,[rr],[15]],om=[3,rF,"ToolResultBlockDelta",0,[rO,rr],[0,15]],oh=[3,rF,"ToolResultContentBlock",0,[rr,rO,rt,tZ,r$,rv],[15,0,[()=>nW,0],()=>nn,()=>iC,()=>ii]],oy=[3,rF,"VideoSource",0,[tF,rx],[21,()=>ir]],ob=[9,rF,"InvokeModel",{http:["POST","/model/{modelId}/invoke",200]},()=>nY,()=>nQ];class ox extends tb.Command.classBuilder().ep(O).m(function(e,t,r,n){return[(0,ty.getEndpointPlugin)(r,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","InvokeModel",{}).n("BedrockRuntimeClient","InvokeModelCommand").sc(ob).build(){}let ov=null;function ow(e="us-east-1"){return ov||(ov=new th({region:e})),ov}async function oS(e,t,r="amazon.nova-canvas-v1:0"){let n=ow(),i=new ox({modelId:r,contentType:"application/json",accept:"application/json",body:JSON.stringify({taskType:"BACKGROUND_REMOVAL",backgroundRemovalParams:{image:e},imageGenerationConfig:{quality:"premium",width:1024,height:1024,numberOfImages:1}})}),o=await n.send(i),a=JSON.parse(new TextDecoder().decode(o.body));if(a.images&&a.images.length>0)return a.images[0];throw Error("No image returned from Nova Canvas")}async function ok(e,t,r="us.mistral.pixtral-large-2502-v1:0"){let n=ow(),i=`Analyze this clothing/apparel item and provide a concise product description.

Focus on:
1. Type of garment (shirt, pants, dress, jacket, etc.)
2. Primary color(s)
3. Material/fabric (if visible)
4. Notable features (buttons, pockets, pattern, style)
5. Condition (new, like new, good, fair - if visible)

Respond in JSON format:
{
  "description": "Brief 2-3 sentence product description",
  "category": "clothing category",
  "color": "primary color",
  "features": ["feature1", "feature2", "feature3"],
  "condition": "estimated condition"
}`,o=new ox({modelId:r,contentType:"application/json",accept:"application/json",body:JSON.stringify({messages:[{role:"user",content:[{type:"image_url",image_url:`data:image/jpeg;base64,${e}`},{type:"text",text:t?`${i}

Product name hint: "${t}"`:i}]}],max_tokens:1024,temperature:.3})});try{let e=await n.send(o),t=JSON.parse(new TextDecoder().decode(e.body)),r=(t.choices?.[0]?.message?.content||t.content?.[0]?.text||"").match(/\{[\s\S]*\}/);if(r){let e=JSON.parse(r[0]);return{description:e.description||"Product description not available",category:e.category||"Clothing",color:e.color||"Unknown",features:e.features||[],condition:e.condition}}}catch(e){console.error("Failed to generate product description:",e)}return{description:t?`${t} - See image for details`:"Clothing item - See image for details",category:"Clothing",color:"Unknown",features:[]}}async function oC(e,t,r="openai.gpt-oss-safeguard-20b"){let n=ow(),i=t?`
Context: This is a ${t} for an e-commerce/consignment store.`:"",o=new ox({modelId:r,contentType:"application/json",accept:"application/json",body:JSON.stringify({messages:[{role:"user",content:`Translate the following English text to Icelandic.
Maintain the same tone, style, and meaning.
For product descriptions, use natural Icelandic retail/e-commerce terminology.${i}

English text:
${e}

Icelandic translation:`}],max_tokens:1024,temperature:.3})});try{let e=await n.send(o),t=JSON.parse(new TextDecoder().decode(e.body));return(t.choices?.[0]?.message?.content||t.content?.[0]?.text||"").trim()}catch(t){return console.error("Failed to translate to Icelandic:",t),e}}async function oE(e,t){let r=await ok(e,t),[n,i,o,a,s]=await Promise.all([oC(r.description,"product description"),oC(r.category,"clothing category"),oC(r.color,"color"),Promise.all(r.features.map(e=>oC(e,"product feature"))),r.condition?oC(r.condition,"product condition"):Promise.resolve(void 0)]);return{en:r,is:{description:n,category:i,color:o,features:a,condition:s}}}async function oP(e,t,r={format:"png",quality:95,autoTrim:!0,centerSubject:!0,enhanceColors:!0}){let n,i,o=await (0,a.default)(e).metadata(),s=e.length,c=e.toString("base64");console.log("Processing with Nova Canvas...");let d=await oS(c,t),l=Buffer.from(d,"base64");console.log("Background removed successfully");let u=(0,a.default)(l);if(r.autoTrim&&(console.log("Auto-trimming whitespace..."),u=u.trim({background:{r:0,g:0,b:0,alpha:0},threshold:10})),r.centerSubject){console.log("Centering subject...");let e=await u.metadata();if(e.width&&e.height){let t=Math.floor(.05*e.width),r=Math.floor(.05*e.height);u=u.extend({top:r,bottom:r,left:t,right:t,background:{r:255,g:255,b:255,alpha:0}})}}r.enhanceColors&&(console.log("Enhancing colors..."),u=u.modulate({saturation:1.15,brightness:1.05}).sharpen({sigma:.5,m1:1,m2:.2})),r.targetSize&&(console.log(`Resizing to ${r.targetSize.width}x${r.targetSize.height}...`),u=u.resize(r.targetSize.width,r.targetSize.height,{fit:"inside",withoutEnlargement:!1,background:{r:255,g:255,b:255,alpha:0}}));let g=await u.toFormat(r.format,{quality:r.quality}).toBuffer(),f=await (0,a.default)(g).metadata();if(console.log("Image processing complete",{originalSize:`${(s/1024).toFixed(2)}KB`,processedSize:`${(g.length/1024).toFixed(2)}KB`,dimensions:`${f.width}x${f.height}`}),r.generateDescription){console.log("Generating bilingual product description (EN + IS) with Mistral Pixtral + GPT-OSS...");try{let e=g.toString("base64");i=(n=await oE(e,r.productName)).en,console.log("Bilingual description generated:"),console.log("  EN:",n.en.description),console.log("  IS:",n.is.description)}catch(e){console.error("Failed to generate bilingual product description:",e)}}return{outputBuffer:g,metadata:{width:f.width||o.width||0,height:f.height||o.height||0,originalSize:s,processedSize:g.length},productDescription:i,bilingualDescription:n}}async function oA(e,t={format:"png",quality:95}){let r=await fetch(e);if(!r.ok)throw Error(`Failed to fetch image: ${r.statusText}`);let n=r.headers.get("content-type")||"image/jpeg";return oP(Buffer.from(await r.arrayBuffer()),n,t)}async function oR(e,t="image/png",r={format:"png",quality:95}){let n=e.replace(/^data:image\/\w+;base64,/,"");return oP(Buffer.from(n,"base64"),t,r)}function oT(e,t,r,n,i=0){return{success:e,jobId:(0,s.randomUUID)(),outputUrl:t,error:n,processingTimeMs:i,metadata:r}}e.s(["createProcessResult",()=>oT,"processImageFromBase64",()=>oR,"processImageFromUrl",()=>oA],81732);var oI=e.i(15233);e.i(94221),e.i(76271);let oO="X-Amz-S3session-Token",oU=oO.toLowerCase();class oB extends oI.SignatureV4{async signWithCredentials(e,t,r){let n=oD(t);return e.headers[oU]=t.sessionToken,oM(this,n),this.signRequest(e,r??{})}async presignWithCredentials(e,t,r){let n=oD(t);return delete e.headers[oU],e.headers[oO]=t.sessionToken,e.query=e.query??{},e.query[oO]=t.sessionToken,oM(this,n),this.presign(e,r)}}function oD(e){return{accessKeyId:e.accessKeyId,secretAccessKey:e.secretAccessKey,expiration:e.expiration}}function oM(e,t){let r=setTimeout(()=>{throw Error("SignatureV4S3Express credential override was created but not called.")},10),n=e.credentialProvider;e.credentialProvider=()=>(clearTimeout(r),e.credentialProvider=n,Promise.resolve(t))}class oG{sigv4aSigner;sigv4Signer;signerOptions;static sigv4aDependency(){return"none"}constructor(e){this.sigv4Signer=new oB(e),this.signerOptions=e}async sign(e,t={}){return"*"===t.signingRegion?this.getSigv4aSigner().sign(e,t):this.sigv4Signer.sign(e,t)}async signWithCredentials(e,t,r={}){if("*"===r.signingRegion){let e=this.getSigv4aSigner();!1;throw Error('signWithCredentials with signingRegion \'*\' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt')}return this.sigv4Signer.signWithCredentials(e,t,r)}async presign(e,t={}){if("*"===t.signingRegion){let e=this.getSigv4aSigner();!1;throw Error('presign with signingRegion \'*\' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt')}return this.sigv4Signer.presign(e,t)}async presignWithCredentials(e,t,r={}){if("*"===r.signingRegion)throw Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(e,t,r)}getSigv4aSigner(){if(!this.sigv4aSigner)if("node"===this.signerOptions.runtime){!0;throw Error("Neither CRT nor JS SigV4a implementation is available. Please load either @aws-sdk/signature-v4-crt or @aws-sdk/signature-v4a. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt")}else{!0;throw Error("JS SigV4a implementation is not available or not a valid constructor. Please check whether you have installed the @aws-sdk/signature-v4a package explicitly. The CRT implementation is not available for browsers. You must also register the package by calling [require('@aws-sdk/signature-v4a');] or an ESM equivalent such as [import '@aws-sdk/signature-v4a';]. For more information please go to https://github.com/aws/aws-sdk-js-v3#using-javascript-non-crt-implementation-of-sigv4a")}return this.sigv4aSigner}}e.s(["SignatureV4MultiRegion",()=>oG],83692)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__1f339b5c._.js.map