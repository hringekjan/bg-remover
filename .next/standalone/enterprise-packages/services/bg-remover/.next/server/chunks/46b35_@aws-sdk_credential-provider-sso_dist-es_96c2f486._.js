module.exports=[77458,e=>{"use strict";e.s([],57924),e.i(57924);var r=e.i(3993),i=e.i(84396),o=e.i(44569),t=e.i(35926);let s=e=>e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_session||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name);e.s(["isSsoProfile",0,s],29758);var n=e.i(18795),l=e.i(7992),a=e.i(81823);let g=async({ssoStartUrl:i,ssoSession:o,ssoAccountId:t,ssoRegion:s,ssoRoleName:g,ssoClient:f,clientConfig:d,parentClientConfig:c,profile:h,filepath:p,configFilepath:S,ignoreCache:u,logger:w})=>{let _,C,m="To refresh this SSO session run aws sso login with the corresponding profile.";if(o)try{let e=await (0,l.fromSso)({profile:h,filepath:p,configFilepath:S,ignoreCache:u})();_={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new r.CredentialsProviderError(e.message,{tryNextLink:!1,logger:w})}else try{_=await (0,a.getSSOTokenFromFile)(i)}catch(e){throw new r.CredentialsProviderError(`The SSO session associated with this profile is invalid. ${m}`,{tryNextLink:!1,logger:w})}if(new Date(_.expiresAt).getTime()-Date.now()<=0)throw new r.CredentialsProviderError(`The SSO session associated with this profile has expired. ${m}`,{tryNextLink:!1,logger:w});let{accessToken:y}=_,{SSOClient:v,GetRoleCredentialsCommand:P}=await e.A(60789),O=f||new v(Object.assign({},d??{},{logger:d?.logger??c?.logger,region:d?.region??s,userAgentAppId:d?.userAgentAppId??c?.userAgentAppId}));try{C=await O.send(new P({accountId:t,roleName:g,accessToken:y}))}catch(e){throw new r.CredentialsProviderError(e,{tryNextLink:!1,logger:w})}let{roleCredentials:{accessKeyId:k,secretAccessKey:A,sessionToken:E,expiration:x,credentialScope:N,accountId:L}={}}=C;if(!k||!A||!E||!x)throw new r.CredentialsProviderError("SSO returns an invalid temporary credential.",{tryNextLink:!1,logger:w});let I={accessKeyId:k,secretAccessKey:A,sessionToken:E,expiration:new Date(x),...N&&{credentialScope:N},...L&&{accountId:L}};return o?(0,n.setCredentialFeature)(I,"CREDENTIALS_SSO","s"):(0,n.setCredentialFeature)(I,"CREDENTIALS_SSO_LEGACY","u"),I},f=(e,i)=>{let{sso_start_url:o,sso_account_id:t,sso_region:s,sso_role_name:n}=e;if(!o||!t||!s||!n)throw new r.CredentialsProviderError(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:i});return e};e.s(["validateSsoProfile",0,f],83327);let d=(e={})=>async({callerClientConfig:n}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:l,ssoAccountId:a,ssoRegion:d,ssoRoleName:c,ssoSession:h}=e,{ssoClient:p}=e,S=(0,i.getProfileName)({profile:e.profile??n?.profile});if(l||a||d||c||h)if(l&&a&&d&&c)return g({ssoStartUrl:l,ssoSession:h,ssoAccountId:a,ssoRegion:d,ssoRoleName:c,ssoClient:p,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,profile:S,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger});else throw new r.CredentialsProviderError('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});{let i=(await (0,t.parseKnownFiles)(e))[S];if(!i)throw new r.CredentialsProviderError(`Profile ${S} was not found.`,{logger:e.logger});if(!s(i))throw new r.CredentialsProviderError(`Profile ${S} is not configured with SSO credentials.`,{logger:e.logger});if(i?.sso_session){let t=(await (0,o.loadSsoSessionData)(e))[i.sso_session],s=` configurations in profile ${S} and sso-session ${i.sso_session}`;if(d&&d!==t.sso_region)throw new r.CredentialsProviderError("Conflicting SSO region"+s,{tryNextLink:!1,logger:e.logger});if(l&&l!==t.sso_start_url)throw new r.CredentialsProviderError("Conflicting SSO start_url"+s,{tryNextLink:!1,logger:e.logger});i.sso_region=t.sso_region,i.sso_start_url=t.sso_start_url}let{sso_start_url:n,sso_account_id:a,sso_region:c,sso_role_name:h,sso_session:u}=f(i,e.logger);return g({ssoStartUrl:n,ssoSession:u,ssoAccountId:a,ssoRegion:c,ssoRoleName:h,ssoClient:p,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,profile:S,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}};e.s(["fromSSO",0,d],10989),e.i(10989),e.i(29758),e.s([],33882),e.i(33882),e.i(83327),e.s(["fromSSO",0,d,"isSsoProfile",0,s,"validateSsoProfile",0,f],77458)},60789,e=>{e.v(r=>Promise.all(["server/chunks/171ef_@smithy_core_dist-es_util-identity-and-auth_httpAuthSchemes_noAuth_c131b644.js","server/chunks/16567__pnpm_ad4ea36a._.js"].map(r=>e.l(r))).then(()=>r(74693)))}];

//# sourceMappingURL=46b35_%40aws-sdk_credential-provider-sso_dist-es_96c2f486._.js.map